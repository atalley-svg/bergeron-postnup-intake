<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intake Questionnaire — Marital Property Agreement | The Talley Law Firm PLLC</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
  theme: {
    extend: {
      colors: {
        firm: { dark: '#1e3a5f', mid: '#2c5282', light: '#ebf4ff', accent: '#c53030' }
      }
    }
  }
}
</script>
<style>
  .step { display: none; }
  .step.active { display: block; }
  [data-conditional] { display: none; }
  [data-conditional].visible { display: block; }
  .toast { position: fixed; top: 20px; right: 20px; z-index: 9999; padding: 12px 24px; border-radius: 8px; color: white; font-weight: 500; box-shadow: 0 4px 12px rgba(0,0,0,.15); transition: opacity .3s; }
  .toast.success { background: #38a169; }
  .toast.error { background: #e53e3e; }
  .drag-over { border-color: #2c5282 !important; background: #ebf4ff !important; }
  @media print { .no-print { display: none !important; } }
</style>
</head>
<body class="bg-gray-50 min-h-screen">

<!-- PASSWORD GATE -->
<div id="password-gate" class="min-h-screen flex items-center justify-center bg-gray-50">
  <div class="bg-white shadow-lg rounded-lg overflow-hidden max-w-md w-full mx-4">
    <div class="bg-[#1e3a5f] text-white px-6 py-5 text-center">
      <img src="logo.png" alt="The Talley Law Firm PLLC" class="h-14 mx-auto mb-3" onerror="this.style.display='none'">
      <h1 class="text-lg font-bold tracking-wide">THE TALLEY LAW FIRM PLLC</h1>
      <p class="text-blue-200 text-sm mt-1">Marital Property Agreement — Intake Questionnaire</p>
    </div>
    <div class="p-6">
      <p class="text-sm text-gray-600 mb-4 text-center">This questionnaire is confidential. Please enter the access password provided by your attorney.</p>
      <div class="space-y-4">
        <div>
          <label for="gate-password" class="block text-sm font-medium text-gray-700 mb-1">Password</label>
          <input type="password" id="gate-password" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Enter access password" onkeydown="if(event.key==='Enter')unlockForm()">
        </div>
        <div id="gate-error" class="hidden text-sm text-red-600 bg-red-50 border border-red-200 rounded-md px-3 py-2">Incorrect password. Please try again or contact your attorney.</div>
        <button type="button" onclick="unlockForm()" class="w-full bg-[#1e3a5f] hover:bg-[#2c5282] text-white font-medium py-2 px-4 rounded-md transition-colors">Access Questionnaire</button>
      </div>
    </div>
    <div class="px-6 pb-4 text-center">
      <p class="text-xs text-gray-400">If you have trouble accessing this form, please contact<br>(832) 889-3229 &middot; atalley@thetalleylaw.com</p>
    </div>
  </div>
</div>

<script>
async function unlockForm() {
  const input = document.getElementById('gate-password').value;
  const encoder = new TextEncoder();
  const data = encoder.encode(input);
  const hashBuffer = await crypto.subtle.digest('SHA-256', data);
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  const hashHex = hashArray.map(function(b) { return b.toString(16).padStart(2, '0'); }).join('');
  if (hashHex === 'beb7b66fb39dc17ad71c5e7b35c4c37e2e5cbe980c2ab92bfcebc1c6d2b032ea') {
    document.getElementById('password-gate').style.display = 'none';
    document.getElementById('form-content').style.display = 'block';
  } else {
    document.getElementById('gate-error').classList.remove('hidden');
    document.getElementById('gate-password').value = '';
    document.getElementById('gate-password').focus();
  }
}
</script>

<!-- FORM CONTENT (hidden until password is entered) -->
<div id="form-content" style="display:none;">

<!-- Honeypot -->
<input type="text" name="website" id="honeypot" style="position:absolute;left:-9999px" tabindex="-1" autocomplete="off">

<!-- HEADER -->
<header class="bg-firm-dark text-white">
  <div class="max-w-5xl mx-auto px-4 py-4 flex items-center justify-between flex-wrap gap-4">
    <div class="flex items-center gap-4">
      <img id="firm-logo" src="logo.png" alt="The Talley Law Firm PLLC" class="h-14 w-auto" onerror="this.style.display='none'">
      <div>
        <h1 class="text-xl font-bold tracking-wide">THE TALLEY LAW FIRM PLLC</h1>
        <p class="text-sm text-blue-200">1506 E. Winding Way Drive, Suite 103, Friendswood, Texas 77546</p>
        <p class="text-xs text-blue-300">(832) 889-3229 &middot; atalley@thetalleylaw.com</p>
      </div>
    </div>
    <div class="text-right text-sm">
      <p class="font-semibold text-blue-100">INTAKE QUESTIONNAIRE</p>
      <p class="text-blue-200">Marital Property Agreement</p>
      <p class="text-blue-300 text-xs">(Partition &amp; Exchange)</p>
    </div>
  </div>
</header>

<!-- MATTER INFO BAR -->
<div class="bg-firm-light border-b border-blue-200">
  <div class="max-w-5xl mx-auto px-4 py-3 grid grid-cols-2 md:grid-cols-4 gap-2 text-sm">
    <div><span class="text-gray-500">Client:</span> <strong>Karen Bergeron</strong></div>
    <div><span class="text-gray-500">Matter:</span> <strong>Marital Property Agreement</strong></div>
    <div><span class="text-gray-500">Spouse:</span> <strong>Michael Bergeron</strong></div>
    <div><span class="text-gray-500">Attorney:</span> <strong>Andrew Talley</strong></div>
  </div>
</div>

<main class="max-w-5xl mx-auto px-4 py-6">

<!-- PROGRESS BAR -->
<div class="no-print mb-6" id="progress-bar">
  <div class="flex items-center justify-between mb-2">
    <span class="text-sm font-medium text-gray-700" id="progress-text">Step 1 of 15</span>
    <span class="text-sm text-gray-500" id="stepLabel">General Information</span>
  </div>
  <div class="w-full bg-gray-200 rounded-full h-3">
    <div id="progress-fill" class="bg-firm-mid h-3 rounded-full transition-all duration-300" style="width:6.67%"></div>
  </div>
</div>

<!-- FORM -->
<form id="intake-form" novalidate>

<!-- ================================================================== -->
<!-- SECTION 1: GENERAL INFORMATION                                     -->
<!-- ================================================================== -->
<div class="step active" data-step="1">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-firm-dark text-white px-6 py-3 font-bold text-lg">Section 1: General Information</div>
    <div class="p-6 space-y-6">

      <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-blue-800 space-y-1">
        <p class="font-semibold mb-2">INSTRUCTIONS</p>
        <ul class="list-disc ml-5 space-y-1">
          <li>Please complete this questionnaire as thoroughly as possible. If a question does not apply, write "N/A."</li>
          <li>Approximate values are acceptable where exact figures are not readily available — indicate "approx." where estimated.</li>
          <li>Both spouses should complete a separate questionnaire or clearly indicate which answers apply to which spouse.</li>
          <li>Attach additional pages if more space is needed for any section.</li>
          <li>Supporting documents (statements, deeds, titles) are helpful but not required at this stage. Upload completed questionnaire and any attachments to the shared Dropbox folder.</li>
        </ul>
      </div>

      <!-- 1A. Client -->
      <div>
        <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4">1A. Client (Karen Bergeron)</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-1">Full Legal Name</label><input type="text" name="s1_client_fullName" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Karen Bergeron"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Date of Birth</label><input type="date" name="s1_client_dob" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">SSN (last 4)</label><input type="text" name="s1_client_ssn4" maxlength="4" pattern="\d{4}" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="XXXX"></div>
          <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-1">Current Mailing Address</label><input type="text" name="s1_client_address" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">City/State/Zip</label><input type="text" name="s1_client_cityStateZip" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">County</label><input type="text" name="s1_client_county" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Phone (primary)</label><input type="tel" name="s1_client_phone" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Email</label><input type="email" name="s1_client_email" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Employer</label><input type="text" name="s1_client_employer" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Job Title</label><input type="text" name="s1_client_jobTitle" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Annual Gross Income (salary/wages)</label><div class="relative"><span class="absolute left-3 top-2 text-gray-500">$</span><input type="text" name="s1_client_grossIncome" class="w-full border border-gray-300 rounded-md pl-7 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0.00"></div></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Other Income (source &amp; amount)</label><input type="text" name="s1_client_otherIncome" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Describe source and amount"></div>
        </div>
      </div>

      <!-- 1B. Spouse -->
      <div>
        <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4">1B. Spouse (Michael Bergeron)</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-1">Full Legal Name</label><input type="text" name="s1_spouse_fullName" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Michael Bergeron"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Date of Birth</label><input type="date" name="s1_spouse_dob" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">SSN (last 4)</label><input type="text" name="s1_spouse_ssn4" maxlength="4" pattern="\d{4}" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="XXXX"></div>
          <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-1">Current Mailing Address (if different)</label><input type="text" name="s1_spouse_address" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Phone (primary)</label><input type="tel" name="s1_spouse_phone" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Email</label><input type="email" name="s1_spouse_email" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Employer</label><input type="text" name="s1_spouse_employer" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Job Title</label><input type="text" name="s1_spouse_jobTitle" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Annual Gross Income (salary/wages)</label><div class="relative"><span class="absolute left-3 top-2 text-gray-500">$</span><input type="text" name="s1_spouse_grossIncome" class="w-full border border-gray-300 rounded-md pl-7 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0.00"></div></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Other Income (source &amp; amount)</label><input type="text" name="s1_spouse_otherIncome" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Describe source and amount"></div>
        </div>
      </div>

      <!-- 1C. Marriage -->
      <div>
        <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4">1C. Marriage Information</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Date of Marriage</label><input type="date" name="s1_marriage_date" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div><label class="block text-sm font-medium text-gray-700 mb-1">Place of Marriage (city/state)</label><input type="text" name="s1_marriage_place" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
          <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-2">Type of Marriage</label><div class="flex gap-6"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s1_marriage_type" value="Ceremonial" class="mr-2"> Ceremonial</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s1_marriage_type" value="Informal/Common Law" class="mr-2"> Informal/Common Law</label></div></div>
        </div>
      </div>

      <!-- Prior Marriages & Children -->
      <div class="space-y-4">
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Prior Marriages? Karen</label><div class="flex gap-6"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s1_priorMarriage_karen" value="Yes" class="mr-2"> Yes</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s1_priorMarriage_karen" value="No" class="mr-2"> No</label></div><div data-conditional data-show-when="s1_priorMarriage_karen" data-show-value="Yes" class="mt-2"><label class="block text-sm text-gray-600 mb-1">If yes, how terminated and when:</label><input type="text" name="s1_priorMarriage_karen_details" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Prior Marriages? Michael</label><div class="flex gap-6"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s1_priorMarriage_michael" value="Yes" class="mr-2"> Yes</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s1_priorMarriage_michael" value="No" class="mr-2"> No</label></div><div data-conditional data-show-when="s1_priorMarriage_michael" data-show-value="Yes" class="mt-2"><label class="block text-sm text-gray-600 mb-1">If yes, how terminated and when:</label><input type="text" name="s1_priorMarriage_michael_details" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Children of this marriage?</label><div class="flex gap-6"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s1_childrenOfMarriage" value="Yes" class="mr-2"> Yes</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s1_childrenOfMarriage" value="No" class="mr-2"> No</label></div><div data-conditional data-show-when="s1_childrenOfMarriage" data-show-value="Yes" class="mt-2"><label class="block text-sm text-gray-600 mb-1">List names and DOBs:</label><textarea name="s1_childrenOfMarriage_list" rows="3" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Children from prior relationships (either spouse)?</label><div class="flex gap-6"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s1_childrenPrior" value="Yes" class="mr-2"> Yes</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s1_childrenPrior" value="No" class="mr-2"> No</label></div><div data-conditional data-show-when="s1_childrenPrior" data-show-value="Yes" class="mt-2"><label class="block text-sm text-gray-600 mb-1">List names, DOBs, and which spouse's child:</label><textarea name="s1_childrenPrior_list" rows="3" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Existing premarital or marital property agreement?</label><div class="flex gap-6"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s1_existingAgreement" value="Yes" class="mr-2"> Yes</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s1_existingAgreement" value="No" class="mr-2"> No</label></div><div data-conditional data-show-when="s1_existingAgreement" data-show-value="Yes" class="mt-2"><p class="text-sm text-amber-700 bg-amber-50 border-l-4 border-amber-500 p-3"><em>If yes, please upload a copy to the Dropbox folder.</em></p></div></div>
      </div>

      <!-- File Upload -->
      <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-firm-mid transition-colors" data-upload="s1_files">
        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 48 48"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M24 8v24m-8-8l8 8 8-8M8 36h32"/></svg>
        <input type="file" multiple class="hidden" id="upload_s1" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.xlsx,.xls">
        <label for="upload_s1" class="cursor-pointer"><p class="mt-2 text-sm text-gray-600">Drag &amp; drop files here or <span class="text-firm-mid font-medium">browse</span></p><p class="mt-1 text-xs text-gray-400">PDF, DOC, DOCX, JPG, PNG, XLS, XLSX — Max 25MB per file</p></label>
        <div class="file-list mt-3 space-y-1"></div>
      </div>
    </div>
  </div>
  <div class="flex justify-between items-center"><div></div><div class="flex gap-3"><button type="button" onclick="saveProgress()" class="border border-firm-dark text-firm-dark hover:bg-blue-50 px-4 py-2 rounded-md text-sm">Save Progress</button><button type="button" onclick="nextStep()" class="bg-firm-dark hover:bg-firm-mid text-white px-6 py-2 rounded-md">Next &rarr;</button></div></div>
</div>

<!-- ================================================================== -->
<!-- SECTION 2: REAL PROPERTY                                           -->
<!-- ================================================================== -->
<div class="step" data-step="2">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-firm-dark text-white px-6 py-3 font-bold text-lg">Section 2: Real Property</div>
    <div class="p-6 space-y-6">
      <p class="text-sm text-gray-600 italic">List ALL real property owned by either or both spouses, including out-of-state property.</p>
      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4">Property #1 — Louisiana Residence</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-1">Street Address</label><input type="text" name="s2_p1_streetAddress" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">City</label><input type="text" name="s2_p1_city" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
        <div class="grid grid-cols-2 gap-2"><div><label class="block text-sm font-medium text-gray-700 mb-1">State</label><input type="text" name="s2_p1_state" value="LA" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div><div><label class="block text-sm font-medium text-gray-700 mb-1">Zip</label><input type="text" name="s2_p1_zip" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">County/Parish</label><input type="text" name="s2_p1_county" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Legal Description (if known)</label><input type="text" name="s2_p1_legalDesc" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Approx. Fair Market Value</label><div class="relative"><span class="absolute left-3 top-2 text-gray-500">$</span><input type="text" name="s2_p1_fmv" class="w-full border border-gray-300 rounded-md pl-7 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Outstanding Mortgage Balance</label><div class="relative"><span class="absolute left-3 top-2 text-gray-500">$</span><input type="text" name="s2_p1_mortgageBal" class="w-full border border-gray-300 rounded-md pl-7 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Monthly Mortgage Payment</label><div class="relative"><span class="absolute left-3 top-2 text-gray-500">$</span><input type="text" name="s2_p1_mortgagePmt" class="w-full border border-gray-300 rounded-md pl-7 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Lender Name</label><input type="text" name="s2_p1_lender" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Date Purchased</label><input type="date" name="s2_p1_datePurchased" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Purchase Price</label><div class="relative"><span class="absolute left-3 top-2 text-gray-500">$</span><input type="text" name="s2_p1_purchasePrice" class="w-full border border-gray-300 rounded-md pl-7 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-1">Source of Down Payment (which spouse's funds/community?)</label><input type="text" name="s2_p1_downPaymentSource" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
        <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-2">Title held in name of:</label><div class="flex flex-wrap gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s2_p1_titleName" value="Karen" class="mr-2"> Karen</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s2_p1_titleName" value="Michael" class="mr-2"> Michael</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s2_p1_titleName" value="Both/Joint" class="mr-2"> Both/Joint</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s2_p1_titleName" value="Entity" class="mr-2"> Entity</label></div></div>
        <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-2">Characterization claim:</label><div class="flex flex-wrap gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s2_p1_characterization" value="Karen's Separate" class="mr-2"> Karen's Separate</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s2_p1_characterization" value="Michael's Separate" class="mr-2"> Michael's Separate</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s2_p1_characterization" value="Community" class="mr-2"> Community</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s2_p1_characterization" value="Mixed/Unclear" class="mr-2"> Mixed/Unclear</label></div></div>
        <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-1">Explain basis for characterization claim:</label><textarea name="s2_p1_charBasis" rows="3" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="e.g., purchased before marriage with separate funds"></textarea></div>
      </div>

      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4 mt-6">Property #2 — Friendswood Rental / Residence</h3>
      <p class="text-sm text-gray-500 italic mb-3">Please confirm whether this property is rented or owned.</p>
      <div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-2">Is this property:</label><div class="flex gap-6"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s2_p2_type" value="Rented/Leased" class="mr-2"> Rented/Leased</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s2_p2_type" value="Owned" class="mr-2"> Owned</label></div></div>
      <div data-conditional data-show-when="s2_p2_type" data-show-value="Rented/Leased" class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-1">Landlord Name</label><input type="text" name="s2_p2_landlord" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Monthly Rent</label><div class="relative"><span class="absolute left-3 top-2 text-gray-500">$</span><input type="text" name="s2_p2_rent" class="w-full border border-gray-300 rounded-md pl-7 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Lease Term/Expiration</label><input type="text" name="s2_p2_leaseTerm" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
      </div>
      <div data-conditional data-show-when="s2_p2_type" data-show-value="Owned" class="mt-3"><p class="text-sm text-gray-600 italic">If owned — complete the same fields as Property #1.</p><textarea name="s2_p2_ownedDetails" rows="4" class="mt-2 w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Provide full property details"></textarea></div>

      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4 mt-6">Additional Real Property</h3>
      <label class="block text-sm font-medium text-gray-700 mb-2">Any additional real property (investment, land, mineral interests, timeshares)?</label>
      <div class="flex gap-6 mb-3"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s2_additionalProperty" value="Yes" class="mr-2"> Yes</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s2_additionalProperty" value="No" class="mr-2"> No</label></div>
      <div data-conditional data-show-when="s2_additionalProperty" data-show-value="Yes"><textarea name="s2_additionalProperty_details" rows="4" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Briefly list any additional properties"></textarea></div>

      <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-blue-800 mt-4">Upload supporting documents (deeds, mortgage statements) using the file upload areas in each section, or provide them directly to your attorney.</div>
      <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-firm-mid transition-colors" data-upload="s2_files"><input type="file" multiple class="hidden" id="upload_s2" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.xlsx,.xls"><label for="upload_s2" class="cursor-pointer"><p class="text-sm text-gray-600">Drag &amp; drop deeds/mortgage statements or <span class="text-firm-mid font-medium">browse</span></p></label><div class="file-list mt-3 space-y-1"></div></div>
    </div>
  </div>
  <div class="flex justify-between items-center"><button type="button" onclick="prevStep()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-md">&larr; Previous</button><div class="flex gap-3"><button type="button" onclick="saveProgress()" class="border border-firm-dark text-firm-dark hover:bg-blue-50 px-4 py-2 rounded-md text-sm">Save Progress</button><button type="button" onclick="nextStep()" class="bg-firm-dark hover:bg-firm-mid text-white px-6 py-2 rounded-md">Next &rarr;</button></div></div>
</div>

<!-- ================================================================== -->
<!-- SECTION 3: BUSINESS INTERESTS                                      -->
<!-- ================================================================== -->
<div class="step" data-step="3">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-firm-dark text-white px-6 py-3 font-bold text-lg">Section 3: Business Interests</div>
    <div class="p-6 space-y-6">
      <p class="text-sm text-gray-600 italic">Please list all business entities in which either spouse has an ownership interest.</p>
      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4">Business #1</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-1">Business/Entity Name</label><input type="text" name="s3_b1_name" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
        <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-2">Entity Type:</label><div class="flex flex-wrap gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_b1_entityType" value="Sole Prop." class="mr-2"> Sole Prop.</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_b1_entityType" value="Partnership" class="mr-2"> Partnership</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_b1_entityType" value="LLC" class="mr-2"> LLC</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_b1_entityType" value="Corporation" class="mr-2"> Corporation</label></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">State of Formation</label><input type="text" name="s3_b1_stateFormation" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Date Formed</label><input type="date" name="s3_b1_dateFormed" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
        <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-1">Nature of Business</label><input type="text" name="s3_b1_nature" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Karen's Ownership %</label><input type="text" name="s3_b1_karenOwnership" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="%"></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Michael's Ownership %</label><input type="text" name="s3_b1_michaelOwnership" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="%"></div>
        <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-1">Other Owners (names and %)</label><input type="text" name="s3_b1_otherOwners" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Estimated Business Value</label><div class="relative"><span class="absolute left-3 top-2 text-gray-500">$</span><input type="text" name="s3_b1_value" class="w-full border border-gray-300 rounded-md pl-7 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Annual Gross Revenue</label><div class="relative"><span class="absolute left-3 top-2 text-gray-500">$</span><input type="text" name="s3_b1_revenue" class="w-full border border-gray-300 rounded-md pl-7 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Annual Net Income to Karen</label><div class="relative"><span class="absolute left-3 top-2 text-gray-500">$</span><input type="text" name="s3_b1_netKaren" class="w-full border border-gray-300 rounded-md pl-7 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">Annual Net Income to Michael</label><div class="relative"><span class="absolute left-3 top-2 text-gray-500">$</span><input type="text" name="s3_b1_netMichael" class="w-full border border-gray-300 rounded-md pl-7 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-2">Who manages day-to-day operations?</label><div class="flex flex-wrap gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_b1_manager" value="Karen" class="mr-2"> Karen</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_b1_manager" value="Michael" class="mr-2"> Michael</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_b1_manager" value="Both" class="mr-2"> Both</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_b1_manager" value="Other" class="mr-2"> Other</label></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Existing buy-sell or operating agreement?</label><div class="flex gap-6"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_b1_buySell" value="Yes" class="mr-2"> Yes</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_b1_buySell" value="No" class="mr-2"> No</label></div><div data-conditional data-show-when="s3_b1_buySell" data-show-value="Yes" class="mt-2"><p class="text-sm text-amber-700 bg-amber-50 border-l-4 border-amber-500 p-3"><em>Please upload a copy to the Dropbox folder.</em></p></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Business bank accounts?</label><div class="flex gap-6"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_b1_bankAccts" value="Yes" class="mr-2"> Yes</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_b1_bankAccts" value="No" class="mr-2"> No</label></div><div data-conditional data-show-when="s3_b1_bankAccts" data-show-value="Yes" class="mt-2"><label class="block text-sm text-gray-600 mb-1">Institution(s) and approx. balance(s):</label><input type="text" name="s3_b1_bankAccts_details" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-2">When was business started?</label><div class="flex gap-6"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_b1_whenStarted" value="Before marriage" class="mr-2"> Before marriage</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_b1_whenStarted" value="During marriage" class="mr-2"> During marriage</label></div><div data-conditional data-show-when="s3_b1_whenStarted" data-show-value="Before marriage" class="mt-2"><label class="block text-sm text-gray-600 mb-1">If before marriage, by which spouse?</label><input type="text" name="s3_b1_whichSpouse" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-1">Describe what each spouse contributes (roles, hours, responsibilities):</label><textarea name="s3_b1_contributions" rows="3" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea></div>
      </div>
      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4 mt-6">Additional Business Interests</h3>
      <label class="block text-sm font-medium text-gray-700 mb-2">Any additional businesses (either spouse)?</label>
      <div class="flex gap-6 mb-3"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_additionalBiz" value="Yes" class="mr-2"> Yes</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s3_additionalBiz" value="No" class="mr-2"> No</label></div>
      <div data-conditional data-show-when="s3_additionalBiz" data-show-value="Yes"><textarea name="s3_additionalBiz_details" rows="3" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="List briefly here"></textarea></div>
      <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-blue-800 mt-4">Upload business documents using the file upload area above, or provide them directly to your attorney.</div>
      <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-firm-mid transition-colors" data-upload="s3_files"><input type="file" multiple class="hidden" id="upload_s3" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.xlsx,.xls"><label for="upload_s3" class="cursor-pointer"><p class="text-sm text-gray-600">Drag &amp; drop business documents or <span class="text-firm-mid font-medium">browse</span></p></label><div class="file-list mt-3 space-y-1"></div></div>
    </div>
  </div>
  <div class="flex justify-between items-center"><button type="button" onclick="prevStep()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-md">&larr; Previous</button><div class="flex gap-3"><button type="button" onclick="saveProgress()" class="border border-firm-dark text-firm-dark hover:bg-blue-50 px-4 py-2 rounded-md text-sm">Save Progress</button><button type="button" onclick="nextStep()" class="bg-firm-dark hover:bg-firm-mid text-white px-6 py-2 rounded-md">Next &rarr;</button></div></div>
</div>

<!-- ================================================================== -->
<!-- SECTION 4: FINANCIAL ACCOUNTS                                      -->
<!-- ================================================================== -->
<div class="step" data-step="4">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-firm-dark text-white px-6 py-3 font-bold text-lg">Section 4: Financial Accounts</div>
    <div class="p-6 space-y-6">
      <p class="text-sm text-gray-600 italic">List ALL bank, investment, and retirement accounts for both spouses.</p>
      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4">4A. Bank Accounts (Checking, Savings, CDs, Money Market)</h3>
      <p class="text-xs text-gray-500 mb-2">List every account. For joint accounts, note both names.</p>
      <div class="overflow-x-auto"><table class="w-full text-sm" id="table_bankAccounts" data-table="table_bankAccounts"><thead><tr class="bg-gray-100"><th class="px-2 py-2 text-left">Institution</th><th class="px-2 py-2 text-left">Account Type</th><th class="px-2 py-2 text-left">Owner(s)</th><th class="px-2 py-2 text-left">Approx. Balance</th><th class="px-2 py-2 text-left">Sep/Comm?</th></tr></thead><tbody>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4a_bank_1_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_1_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_1_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_1_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_1_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4a_bank_2_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_2_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_2_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_2_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_2_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4a_bank_3_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_3_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_3_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_3_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_3_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4a_bank_4_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_4_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_4_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_4_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_4_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4a_bank_5_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_5_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_5_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_5_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_5_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4a_bank_6_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_6_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_6_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_6_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4a_bank_6_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
      </tbody></table></div>
      <button type="button" onclick="addTableRow('table_bankAccounts')" class="text-sm text-firm-mid hover:underline">+ Add Row</button>

      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4 mt-6">4B. Investment / Brokerage Accounts</h3>
      <div class="overflow-x-auto"><table class="w-full text-sm" id="table_investAccounts" data-table="table_investAccounts"><thead><tr class="bg-gray-100"><th class="px-2 py-2 text-left">Institution</th><th class="px-2 py-2 text-left">Account Type</th><th class="px-2 py-2 text-left">Owner(s)</th><th class="px-2 py-2 text-left">Approx. Value</th><th class="px-2 py-2 text-left">Sep/Comm?</th></tr></thead><tbody>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4b_invest_1_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_1_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_1_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_1_value" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_1_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4b_invest_2_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_2_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_2_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_2_value" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_2_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4b_invest_3_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_3_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_3_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_3_value" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_3_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4b_invest_4_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_4_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_4_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_4_value" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4b_invest_4_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
      </tbody></table></div>
      <button type="button" onclick="addTableRow('table_investAccounts')" class="text-sm text-firm-mid hover:underline">+ Add Row</button>

      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4 mt-6">4C. Retirement Accounts</h3>
      <p class="text-xs text-gray-500 mb-2">Include 401(k), 403(b), IRA, Roth IRA, pension, deferred comp, etc.</p>
      <div class="overflow-x-auto"><table class="w-full text-sm" id="table_retirementAccounts" data-table="table_retirementAccounts"><thead><tr class="bg-gray-100"><th class="px-2 py-2 text-left">Owner</th><th class="px-2 py-2 text-left">Plan Type</th><th class="px-2 py-2 text-left">Employer/Institution</th><th class="px-2 py-2 text-left">Approx. Balance</th><th class="px-2 py-2 text-left">Pre-Marriage Amt.</th></tr></thead><tbody>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4c_ret_1_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_1_planType" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_1_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_1_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_1_preMarriage" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4c_ret_2_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_2_planType" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_2_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_2_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_2_preMarriage" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4c_ret_3_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_3_planType" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_3_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_3_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_3_preMarriage" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4c_ret_4_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_4_planType" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_4_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_4_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_4_preMarriage" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4c_ret_5_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_5_planType" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_5_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_5_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_5_preMarriage" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s4c_ret_6_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_6_planType" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_6_institution" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_6_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s4c_ret_6_preMarriage" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td></tr>
      </tbody></table></div>
      <button type="button" onclick="addTableRow('table_retirementAccounts')" class="text-sm text-firm-mid hover:underline">+ Add Row</button>
      <div class="bg-amber-50 border-l-4 border-amber-500 p-3 mt-3 text-sm text-amber-800 space-y-1"><p>For each retirement account, note the approximate balance as of the date of marriage if known.</p><p>Retirement accounts may require a QDRO or similar order to divide — this is outside the scope of the flat fee.</p></div>

      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4 mt-6">4D. Cryptocurrency / Digital Assets</h3>
      <label class="block text-sm font-medium text-gray-700 mb-2">Any cryptocurrency or digital assets?</label>
      <div class="flex gap-6 mb-3"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s4d_crypto" value="Yes" class="mr-2"> Yes</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s4d_crypto" value="No" class="mr-2"> No</label></div>
      <div data-conditional data-show-when="s4d_crypto" data-show-value="Yes"><textarea name="s4d_crypto_details" rows="3" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="List exchange/wallet, type, and approx. value"></textarea></div>
      <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-blue-800 mt-4">Upload most recent account statements using the file upload area above, or provide them directly to your attorney.</div>
      <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-firm-mid transition-colors" data-upload="s4_files"><input type="file" multiple class="hidden" id="upload_s4" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.xlsx,.xls"><label for="upload_s4" class="cursor-pointer"><p class="text-sm text-gray-600">Drag &amp; drop account statements or <span class="text-firm-mid font-medium">browse</span></p></label><div class="file-list mt-3 space-y-1"></div></div>
    </div>
  </div>
  <div class="flex justify-between items-center"><button type="button" onclick="prevStep()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-md">&larr; Previous</button><div class="flex gap-3"><button type="button" onclick="saveProgress()" class="border border-firm-dark text-firm-dark hover:bg-blue-50 px-4 py-2 rounded-md text-sm">Save Progress</button><button type="button" onclick="nextStep()" class="bg-firm-dark hover:bg-firm-mid text-white px-6 py-2 rounded-md">Next &rarr;</button></div></div>
</div>

<!-- ================================================================== -->
<!-- SECTION 5: VEHICLES & PERSONAL PROPERTY                            -->
<!-- ================================================================== -->
<div class="step" data-step="5">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-firm-dark text-white px-6 py-3 font-bold text-lg">Section 5: Vehicles &amp; Personal Property</div>
    <div class="p-6 space-y-6">
      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4">5A. Vehicles (Cars, Trucks, Boats, RVs, Trailers, ATVs)</h3>
      <div class="overflow-x-auto"><table class="w-full text-sm" id="table_vehicles" data-table="table_vehicles"><thead><tr class="bg-gray-100"><th class="px-2 py-2 text-left">Year/Make/Model</th><th class="px-2 py-2 text-left">VIN</th><th class="px-2 py-2 text-left">Title in Name of</th><th class="px-2 py-2 text-left">Value</th><th class="px-2 py-2 text-left">Loan Bal.</th><th class="px-2 py-2 text-left">Sep/Comm</th></tr></thead><tbody>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s5a_veh_1_ymm" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_1_vin" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_1_title" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_1_value" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_1_loanBal" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_1_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s5a_veh_2_ymm" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_2_vin" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_2_title" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_2_value" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_2_loanBal" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_2_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s5a_veh_3_ymm" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_3_vin" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_3_title" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_3_value" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_3_loanBal" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_3_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s5a_veh_4_ymm" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_4_vin" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_4_title" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_4_value" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_4_loanBal" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s5a_veh_4_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
      </tbody></table></div>
      <button type="button" onclick="addTableRow('table_vehicles')" class="text-sm text-firm-mid hover:underline">+ Add Row</button>
      <p class="text-xs text-gray-500 mt-1">For each vehicle with a loan, provide the lender name and monthly payment in the notes section below if needed.</p>

      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4 mt-6">5B. Valuable Personal Property (Items over $1,000)</h3>
      <p class="text-xs text-gray-500 mb-2">Jewelry, art, firearms, collectibles, tools/equipment, electronics, antiques, etc.</p>
      <div class="overflow-x-auto"><table class="w-full text-sm" id="table_personalProp" data-table="table_personalProp"><thead><tr class="bg-gray-100"><th class="px-2 py-2 text-left">Description</th><th class="px-2 py-2 text-left">Owner</th><th class="px-2 py-2 text-left">Approx. Value</th><th class="px-2 py-2 text-left">Sep. or Community?</th></tr></thead><tbody>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s5b_pp_1_desc" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5b_pp_1_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5b_pp_1_value" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s5b_pp_1_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s5b_pp_2_desc" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5b_pp_2_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5b_pp_2_value" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s5b_pp_2_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s5b_pp_3_desc" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5b_pp_3_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5b_pp_3_value" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s5b_pp_3_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s5b_pp_4_desc" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5b_pp_4_owner" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s5b_pp_4_value" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s5b_pp_4_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
      </tbody></table></div>
      <button type="button" onclick="addTableRow('table_personalProp')" class="text-sm text-firm-mid hover:underline">+ Add Row</button>

      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4 mt-6">5C. Household Furnishings</h3>
      <p class="text-xs text-gray-500 mb-2">You do not need to itemize every piece of furniture. Describe the general approach:</p>
      <label class="block text-sm font-medium text-gray-700 mb-2">How will household furnishings be addressed?</label>
      <div class="flex flex-wrap gap-4 mb-3"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s5c_furnishings" value="Divide by agreement" class="mr-2"> Divide by agreement</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s5c_furnishings" value="Each keeps what they have" class="mr-2"> Each keeps what they have</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s5c_furnishings" value="Other" class="mr-2"> Other</label></div>
      <div data-conditional data-show-when="s5c_furnishings" data-show-value="Other"><textarea name="s5c_furnishings_other" rows="2" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Describe"></textarea></div>
      <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-firm-mid transition-colors mt-4" data-upload="s5_files"><input type="file" multiple class="hidden" id="upload_s5" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.xlsx,.xls"><label for="upload_s5" class="cursor-pointer"><p class="text-sm text-gray-600">Drag &amp; drop vehicle titles/loan statements or <span class="text-firm-mid font-medium">browse</span></p></label><div class="file-list mt-3 space-y-1"></div></div>
    </div>
  </div>
  <div class="flex justify-between items-center"><button type="button" onclick="prevStep()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-md">&larr; Previous</button><div class="flex gap-3"><button type="button" onclick="saveProgress()" class="border border-firm-dark text-firm-dark hover:bg-blue-50 px-4 py-2 rounded-md text-sm">Save Progress</button><button type="button" onclick="nextStep()" class="bg-firm-dark hover:bg-firm-mid text-white px-6 py-2 rounded-md">Next &rarr;</button></div></div>
</div>

<!-- ================================================================== -->
<!-- SECTION 6: INSURANCE POLICIES                                      -->
<!-- ================================================================== -->
<div class="step" data-step="6">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-firm-dark text-white px-6 py-3 font-bold text-lg">Section 6: Insurance Policies</div>
    <div class="p-6 space-y-6">
      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4">6A. Life Insurance</h3>
      <div class="overflow-x-auto"><table class="w-full text-sm" id="table_lifeInsurance" data-table="table_lifeInsurance"><thead><tr class="bg-gray-100"><th class="px-2 py-2 text-left">Insured</th><th class="px-2 py-2 text-left">Company</th><th class="px-2 py-2 text-left">Type (Term/Whole)</th><th class="px-2 py-2 text-left">Face Value</th><th class="px-2 py-2 text-left">Cash Value</th><th class="px-2 py-2 text-left">Beneficiary</th></tr></thead><tbody>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s6a_li_1_insured" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s6a_li_1_company" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s6a_li_1_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s6a_li_1_faceValue" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s6a_li_1_cashValue" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s6a_li_1_beneficiary" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s6a_li_2_insured" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s6a_li_2_company" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s6a_li_2_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s6a_li_2_faceValue" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s6a_li_2_cashValue" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s6a_li_2_beneficiary" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s6a_li_3_insured" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s6a_li_3_company" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s6a_li_3_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s6a_li_3_faceValue" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s6a_li_3_cashValue" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s6a_li_3_beneficiary" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
      </tbody></table></div>
      <button type="button" onclick="addTableRow('table_lifeInsurance')" class="text-sm text-firm-mid hover:underline">+ Add Row</button>

      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4 mt-6">6B. Other Insurance</h3>
      <div class="space-y-3">
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Long-term care insurance?</label><div class="flex flex-wrap gap-4"><label class="inline-flex items-center cursor-pointer"><input type="checkbox" name="s6b_ltc_karen" value="Yes" class="mr-2"> Yes — Karen</label><label class="inline-flex items-center cursor-pointer"><input type="checkbox" name="s6b_ltc_michael" value="Yes" class="mr-2"> Yes — Michael</label><label class="inline-flex items-center cursor-pointer"><input type="checkbox" name="s6b_ltc_no" value="No" class="mr-2"> No</label></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Annuities?</label><div class="flex flex-wrap gap-4"><label class="inline-flex items-center cursor-pointer"><input type="checkbox" name="s6b_annuity_karen" value="Yes" class="mr-2"> Yes — Karen</label><label class="inline-flex items-center cursor-pointer"><input type="checkbox" name="s6b_annuity_michael" value="Yes" class="mr-2"> Yes — Michael</label><label class="inline-flex items-center cursor-pointer"><input type="checkbox" name="s6b_annuity_no" value="No" class="mr-2"> No</label></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-1">If yes to either, provide details:</label><textarea name="s6b_otherInsurance_details" rows="3" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea></div>
      </div>
      <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-firm-mid transition-colors mt-4" data-upload="s6_files"><input type="file" multiple class="hidden" id="upload_s6" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.xlsx,.xls"><label for="upload_s6" class="cursor-pointer"><p class="text-sm text-gray-600">Drag &amp; drop insurance documents or <span class="text-firm-mid font-medium">browse</span></p></label><div class="file-list mt-3 space-y-1"></div></div>
    </div>
  </div>
  <div class="flex justify-between items-center"><button type="button" onclick="prevStep()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-md">&larr; Previous</button><div class="flex gap-3"><button type="button" onclick="saveProgress()" class="border border-firm-dark text-firm-dark hover:bg-blue-50 px-4 py-2 rounded-md text-sm">Save Progress</button><button type="button" onclick="nextStep()" class="bg-firm-dark hover:bg-firm-mid text-white px-6 py-2 rounded-md">Next &rarr;</button></div></div>
</div>

<!-- ================================================================== -->
<!-- SECTION 7: DEBTS & LIABILITIES                                     -->
<!-- ================================================================== -->
<div class="step" data-step="7">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-firm-dark text-white px-6 py-3 font-bold text-lg">Section 7: Debts &amp; Liabilities</div>
    <div class="p-6 space-y-6">
      <p class="text-sm text-gray-600 italic">List ALL debts owed by either or both spouses.</p>
      <div class="overflow-x-auto"><table class="w-full text-sm" id="table_debts" data-table="table_debts"><thead><tr class="bg-gray-100"><th class="px-2 py-2 text-left">Creditor</th><th class="px-2 py-2 text-left">Type of Debt</th><th class="px-2 py-2 text-left">Whose Name</th><th class="px-2 py-2 text-left">Balance Owed</th><th class="px-2 py-2 text-left">Monthly Pmt</th><th class="px-2 py-2 text-left">Sep/Comm</th></tr></thead><tbody>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s7_debt_1_creditor" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_1_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_1_whose" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_1_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_1_monthlyPmt" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_1_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s7_debt_2_creditor" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_2_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_2_whose" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_2_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_2_monthlyPmt" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_2_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s7_debt_3_creditor" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_3_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_3_whose" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_3_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_3_monthlyPmt" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_3_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s7_debt_4_creditor" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_4_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_4_whose" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_4_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_4_monthlyPmt" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_4_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s7_debt_5_creditor" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_5_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_5_whose" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_5_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_5_monthlyPmt" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_5_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s7_debt_6_creditor" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_6_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_6_whose" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_6_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_6_monthlyPmt" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_6_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s7_debt_7_creditor" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_7_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_7_whose" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_7_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_7_monthlyPmt" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_7_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s7_debt_8_creditor" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_8_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_8_whose" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_8_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_8_monthlyPmt" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_8_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s7_debt_9_creditor" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_9_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_9_whose" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_9_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_9_monthlyPmt" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_9_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
        <tr class="border-b"><td class="px-1 py-1"><input type="text" name="s7_debt_10_creditor" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_10_type" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_10_whose" class="w-full border rounded px-2 py-1 text-sm"></td><td class="px-1 py-1"><input type="text" name="s7_debt_10_balance" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_10_monthlyPmt" class="w-full border rounded px-2 py-1 text-sm" placeholder="$"></td><td class="px-1 py-1"><input type="text" name="s7_debt_10_sepComm" class="w-full border rounded px-2 py-1 text-sm"></td></tr>
      </tbody></table></div>
      <button type="button" onclick="addTableRow('table_debts')" class="text-sm text-firm-mid hover:underline">+ Add Row</button>
      <p class="text-xs text-gray-500 mt-1">Types: Mortgage, HELOC, Credit Card, Student Loan, Vehicle Loan, Personal Loan, Tax Debt, Medical, Business Debt, Other</p>

      <h3 class="text-firm-mid font-semibold text-base border-b border-gray-200 pb-2 mb-4 mt-6">7A. Tax Liabilities</h3>
      <div class="space-y-4">
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Any outstanding federal or state tax liability?</label><div class="flex gap-6"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s7a_taxLiability" value="Yes" class="mr-2"> Yes</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s7a_taxLiability" value="No" class="mr-2"> No</label></div><div data-conditional data-show-when="s7a_taxLiability" data-show-value="Yes" class="mt-2"><label class="block text-sm text-gray-600 mb-1">Tax year(s) and amount owed:</label><input type="text" name="s7a_taxLiability_details" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">How have you filed taxes during the marriage?</label><div class="flex flex-wrap gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s7a_taxFiling" value="Jointly" class="mr-2"> Jointly</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s7a_taxFiling" value="Separately" class="mr-2"> Separately</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s7a_taxFiling" value="Mixed" class="mr-2"> Mixed</label></div></div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Any pending tax dispute, audit, or installment plan?</label><div class="flex gap-6"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s7a_taxDispute" value="Yes" class="mr-2"> Yes</label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="s7a_taxDispute" value="No" class="mr-2"> No</label></div><div data-conditional data-show-when="s7a_taxDispute" data-show-value="Yes" class="mt-2"><textarea name="s7a_taxDispute_desc" rows="2" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Describe"></textarea></div></div>
      </div>
      <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-firm-mid transition-colors mt-4" data-upload="s7_files"><input type="file" multiple class="hidden" id="upload_s7" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.xlsx,.xls"><label for="upload_s7" class="cursor-pointer"><p class="text-sm text-gray-600">Drag &amp; drop debt/tax statements or <span class="text-firm-mid font-medium">browse</span></p></label><div class="file-list mt-3 space-y-1"></div></div>
    </div>
  </div>
  <div class="flex justify-between items-center"><button type="button" onclick="prevStep()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-md">&larr; Previous</button><div class="flex gap-3"><button type="button" onclick="saveProgress()" class="border border-firm-dark text-firm-dark hover:bg-blue-50 px-4 py-2 rounded-md text-sm">Save Progress</button><button type="button" onclick="nextStep()" class="bg-firm-dark hover:bg-firm-mid text-white px-6 py-2 rounded-md">Next &rarr;</button></div></div>
</div>

<!-- ================================================================== -->
<!-- SECTION 8: SEPARATE PROPERTY CLAIMS                                -->
<!-- ================================================================== -->
<div class="step" data-step="8" style="display:none;">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-[#1e3a5f] text-white px-6 py-3 rounded-t-lg font-bold text-lg">
      Section 8: Separate Property Claims
    </div>
    <div class="p-6 space-y-6">

      <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-blue-800">
        <strong>Texas Law Note:</strong> Under Tex. Fam. Code &sect; 3.001&ndash;3.003, separate property includes property owned before marriage, acquired during marriage by gift or inheritance, and personal injury recovery (excluding loss of earning capacity during marriage).
      </div>

      <!-- 8A. Karen's Separate Property Claims -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">8A. Karen&rsquo;s Separate Property Claims</h3>
        <label class="block text-sm font-medium text-gray-700 mb-1">
          List property Karen claims as her separate property and the basis for each claim:
        </label>
        <textarea name="karen_separate_property_claims" rows="6"
          class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]"
          placeholder="Example: Louisiana residence — purchased by Karen before marriage on 03/15/2018, deed in Karen's sole name. Bank of America savings account #XXXX — inherited funds from Karen's grandmother deposited 06/2020."></textarea>
        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-blue-800 mt-3">
          <strong>Tip:</strong> Supporting documentation (deeds, account statements, inheritance records) strengthens separate property claims. Upload these in Section 14.
        </div>
      </div>

      <!-- 8B. Michael's Separate Property Claims -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">8B. Michael&rsquo;s Separate Property Claims</h3>
        <label class="block text-sm font-medium text-gray-700 mb-1">
          List property Michael claims as his separate property and the basis for each claim:
        </label>
        <textarea name="michael_separate_property_claims" rows="6"
          class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]"
          placeholder="Example: Business ownership interest — founded before marriage on 01/10/2017. Investment account #XXXX — premarital funds, no community contributions."></textarea>
      </div>

      <!-- File Upload -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Supporting Documentation (deeds, account statements, inheritance records):</label>
        <div class="file-upload-area border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors cursor-pointer" data-upload="separate_property_docs">
          <svg class="mx-auto h-10 w-10 text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/></svg>
          <p class="text-sm text-gray-600">Drag &amp; drop files here, or <span class="text-blue-600 font-medium">click to browse</span></p>
          <p class="text-xs text-gray-400 mt-1">PDF, DOC, DOCX, JPG, PNG, XLS, XLSX &mdash; Max 25 MB per file</p>
          <input type="file" class="hidden" name="separate_property_files" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.xlsx,.xls">
        </div>
        <div class="file-list mt-2 space-y-1" data-list="separate_property_docs"></div>
      </div>

    </div>
  </div>

  <!-- Navigation -->
  <div class="flex justify-between items-center mt-6">
    <button type="button" onclick="prevStep()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-md transition-colors">
      &larr; Previous
    </button>
    <button type="button" onclick="saveProgress(false)" class="border border-[#1e3a5f] text-[#1e3a5f] hover:bg-blue-50 px-4 py-2 rounded-md text-sm transition-colors">
      Save Progress
    </button>
    <button type="button" onclick="nextStep()" class="bg-[#1e3a5f] hover:bg-[#2c5282] text-white px-6 py-2 rounded-md transition-colors">
      Next &rarr;
    </button>
  </div>
</div>


<!-- ================================================================== -->
<!-- SECTION 9: PROPOSED DIVISION / TERMS OF AGREEMENT                  -->
<!-- ================================================================== -->
<div class="step" data-step="9" style="display:none;">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-[#1e3a5f] text-white px-6 py-3 rounded-t-lg font-bold text-lg">
      Section 9: Proposed Division / Terms of Agreement
    </div>
    <div class="p-6 space-y-6">

      <!-- 9A. General Approach -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">9A. General Approach &mdash; Type of Agreement</h3>
        <p class="text-sm text-gray-600 mb-3">Select the primary type of marital property agreement:</p>
        <div class="space-y-2">
          <label class="inline-flex items-center mr-6 cursor-pointer">
            <input type="radio" name="agreement_type" value="Partition & Exchange" class="form-radio text-blue-600 mr-2">
            <span class="text-sm">Partition &amp; Exchange Agreement</span>
          </label><br>
          <label class="inline-flex items-center mr-6 cursor-pointer">
            <input type="radio" name="agreement_type" value="Conversion Sep to Comm" class="form-radio text-blue-600 mr-2">
            <span class="text-sm">Conversion Agreement &mdash; Separate to Community</span>
          </label><br>
          <label class="inline-flex items-center mr-6 cursor-pointer">
            <input type="radio" name="agreement_type" value="Conversion Comm to Sep" class="form-radio text-blue-600 mr-2">
            <span class="text-sm">Conversion Agreement &mdash; Community to Separate</span>
          </label><br>
          <label class="inline-flex items-center mr-6 cursor-pointer">
            <input type="radio" name="agreement_type" value="Mixed" class="form-radio text-blue-600 mr-2">
            <span class="text-sm">Mixed (Partition, Exchange, and/or Conversion)</span>
          </label>
        </div>

        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-blue-800 mt-4">
          <strong>Legal Note:</strong> Under Tex. Fam. Code &sect; 4.102, spouses may partition or exchange community property into separate property. Under &sect; 4.203, spouses may convert separate property to community property. A &ldquo;mixed&rdquo; agreement may combine partition, exchange, and conversion provisions.
        </div>
      </div>

      <!-- 9B. Agreed Division — Real Property -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">9B. Agreed Division &mdash; Real Property</h3>
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">How will the Louisiana residence be treated?</label>
            <textarea name="division_louisiana_residence" rows="4"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]"
              placeholder="e.g., Confirmed as Karen's separate property; Michael relinquishes any community claim..."></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">How will the Friendswood rental situation be addressed?</label>
            <textarea name="division_friendswood_rental" rows="4"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]"
              placeholder="e.g., Community property; rental income to be partitioned as follows..."></textarea>
          </div>
        </div>
      </div>

      <!-- 9C. Agreed Division — Business Interests -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">9C. Agreed Division &mdash; Business Interests</h3>
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">How will the business ownership be divided or restructured?</label>
            <textarea name="division_business_ownership" rows="4"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]"
              placeholder="e.g., Karen retains 60% ownership; Michael retains 40%; each party's shares become separate property..."></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">How will future business income be characterized?</label>
            <textarea name="division_business_income_future" rows="4"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]"
              placeholder="e.g., Distributions proportional to ownership become each party's separate property..."></textarea>
          </div>
        </div>
        <div class="bg-amber-50 border-l-4 border-amber-500 p-4 text-sm text-amber-800 mt-3">
          <strong>Scope Note:</strong> Corporate restructuring, stock transfers, and indemnification beyond basic share assignment are outside the flat fee scope and may require additional engagement.
        </div>
      </div>

      <!-- 9D. Agreed Division — Financial Accounts -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">9D. Agreed Division &mdash; Financial Accounts</h3>
        <label class="block text-sm font-medium text-gray-700 mb-1">Describe the proposed division of all bank, investment, and retirement accounts:</label>
        <textarea name="division_financial_accounts" rows="5"
          class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]"
          placeholder="e.g., Joint checking at Chase to be partitioned 50/50 and each party's portion becomes separate property. Karen's 401(k) confirmed as separate. Michael's brokerage account at Schwab partitioned to Michael's separate property..."></textarea>
      </div>

      <!-- 9E. Agreed Division — Debts -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">9E. Agreed Division &mdash; Debts</h3>
        <label class="block text-sm font-medium text-gray-700 mb-1">Describe the proposed allocation of all debts and liabilities:</label>
        <textarea name="division_debts" rows="5"
          class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]"
          placeholder="e.g., Louisiana mortgage remains Karen's sole responsibility. Credit card debt on Amex #XXXX split equally. Student loans remain separate obligations of the incurring party..."></textarea>
      </div>

      <!-- 9F. Agreed Division — Vehicles and Personal Property -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">9F. Agreed Division &mdash; Vehicles and Personal Property</h3>
        <label class="block text-sm font-medium text-gray-700 mb-1">Describe the proposed division of vehicles and personal property:</label>
        <textarea name="division_vehicles_personal" rows="5"
          class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]"
          placeholder="e.g., 2022 BMW X5 to Karen as separate property. 2021 Ford F-150 to Michael as separate property. Household furnishings per attached inventory list..."></textarea>
      </div>

      <!-- File Upload -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Supporting Documentation for Proposed Division:</label>
        <div class="file-upload-area border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors cursor-pointer" data-upload="division_docs">
          <svg class="mx-auto h-10 w-10 text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/></svg>
          <p class="text-sm text-gray-600">Drag &amp; drop files here, or <span class="text-blue-600 font-medium">click to browse</span></p>
          <p class="text-xs text-gray-400 mt-1">PDF, DOC, DOCX, JPG, PNG, XLS, XLSX &mdash; Max 25 MB per file</p>
          <input type="file" class="hidden" name="division_files" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.xlsx,.xls">
        </div>
        <div class="file-list mt-2 space-y-1" data-list="division_docs"></div>
      </div>

    </div>
  </div>

  <!-- Navigation -->
  <div class="flex justify-between items-center mt-6">
    <button type="button" onclick="prevStep()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-md transition-colors">
      &larr; Previous
    </button>
    <button type="button" onclick="saveProgress(false)" class="border border-[#1e3a5f] text-[#1e3a5f] hover:bg-blue-50 px-4 py-2 rounded-md text-sm transition-colors">
      Save Progress
    </button>
    <button type="button" onclick="nextStep()" class="bg-[#1e3a5f] hover:bg-[#2c5282] text-white px-6 py-2 rounded-md transition-colors">
      Next &rarr;
    </button>
  </div>
</div>


<!-- ================================================================== -->
<!-- SECTION 10: QUESTIONS, CONCERNS & ADDITIONAL INFORMATION           -->
<!-- ================================================================== -->
<div class="step" data-step="10" style="display:none;">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-[#1e3a5f] text-white px-6 py-3 rounded-t-lg font-bold text-lg">
      Section 10: Questions, Concerns, or Additional Information for Your Attorney
    </div>
    <div class="p-6 space-y-6">

      <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-blue-800">
        Use this space to note anything not covered above &mdash; questions you'd like to discuss, concerns about the agreement, additional context, or anything else you'd like your attorney to know.
      </div>

      <div>
        <textarea name="general_comments" rows="10"
          class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[200px]"
          placeholder="Type any questions, concerns, or additional information here..."></textarea>
      </div>

    </div>
  </div>

  <!-- Navigation -->
  <div class="flex justify-between items-center mt-6">
    <button type="button" onclick="prevStep()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-md transition-colors">
      &larr; Previous
    </button>
    <button type="button" onclick="saveProgress(false)" class="border border-[#1e3a5f] text-[#1e3a5f] hover:bg-blue-50 px-4 py-2 rounded-md text-sm transition-colors">
      Save Progress
    </button>
    <button type="button" onclick="nextStep()" class="bg-[#1e3a5f] hover:bg-[#2c5282] text-white px-6 py-2 rounded-md transition-colors">
      Next &rarr;
    </button>
  </div>
</div>


<!-- ================================================================== -->
<!-- SECTION 11: INCOME & FUTURE EARNINGS CHARACTERIZATION              -->
<!-- ================================================================== -->
<div class="step" data-step="11" style="display:none;">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-[#1e3a5f] text-white px-6 py-3 rounded-t-lg font-bold text-lg">
      Section 11: Income &amp; Future Earnings Characterization
    </div>
    <div class="p-6 space-y-6">

      <div class="bg-amber-50 border-l-4 border-amber-500 p-4 text-sm text-amber-800">
        <strong>Critical Decision:</strong> How future income is characterized &mdash; as community or separate property &mdash; is one of the most consequential provisions in a marital property agreement. Texas law presumes all income earned during marriage is community property. Changing this default requires clear, specific agreement.
      </div>

      <!-- 11A. Current Income — Karen -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">11A. Current Income &mdash; Karen</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Salary ($):</label>
            <input type="text" name="karen_salary" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="e.g., 125,000">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Pay Frequency:</label>
            <select name="karen_pay_frequency" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
              <option value="">-- Select --</option>
              <option value="Weekly">Weekly</option>
              <option value="Bi-Weekly">Bi-Weekly</option>
              <option value="Semi-Monthly">Semi-Monthly</option>
              <option value="Monthly">Monthly</option>
              <option value="Annually">Annually</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Bonus / Commission ($):</label>
            <input type="text" name="karen_bonus" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Annual amount">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Business Distributions ($):</label>
            <input type="text" name="karen_business_distributions" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Annual amount">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Rental Income ($):</label>
            <input type="text" name="karen_rental_income" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Monthly or annual amount">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Other Income ($):</label>
            <input type="text" name="karen_other_income" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Describe source and amount">
          </div>
        </div>
      </div>

      <!-- 11B. Current Income — Michael -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">11B. Current Income &mdash; Michael</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Salary ($):</label>
            <input type="text" name="michael_salary" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="e.g., 95,000">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Pay Frequency:</label>
            <select name="michael_pay_frequency" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
              <option value="">-- Select --</option>
              <option value="Weekly">Weekly</option>
              <option value="Bi-Weekly">Bi-Weekly</option>
              <option value="Semi-Monthly">Semi-Monthly</option>
              <option value="Monthly">Monthly</option>
              <option value="Annually">Annually</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Bonus / Commission ($):</label>
            <input type="text" name="michael_bonus" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Annual amount">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Business Distributions ($):</label>
            <input type="text" name="michael_business_distributions" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Annual amount">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Rental Income ($):</label>
            <input type="text" name="michael_rental_income" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Monthly or annual amount">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Other Income ($):</label>
            <input type="text" name="michael_other_income" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Describe source and amount">
          </div>
        </div>
      </div>

      <!-- 11C. Future Income Characterization -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">11C. Future Income Characterization</h3>

        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-blue-800 mb-4">
          <strong>Default Texas Law:</strong> Under Tex. Fam. Code &sect; 3.002, all property acquired during marriage (including earned income) is presumed community property. A marital property agreement under &sect; 4.102 can change this presumption for future income, but the agreement must be clear and specific.
        </div>

        <div class="space-y-5">
          <!-- Karen's future earnings -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Proposed treatment of Karen&rsquo;s future earnings:</label>
            <div class="flex flex-wrap gap-4">
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="karen_future_earnings" value="Community" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">Community (Texas default)</span>
              </label>
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="karen_future_earnings" value="Karen's Separate" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">Karen&rsquo;s Separate Property</span>
              </label>
            </div>
          </div>

          <!-- Michael's future earnings -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Proposed treatment of Michael&rsquo;s future earnings:</label>
            <div class="flex flex-wrap gap-4">
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="michael_future_earnings" value="Community" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">Community (Texas default)</span>
              </label>
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="michael_future_earnings" value="Michael's Separate" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">Michael&rsquo;s Separate Property</span>
              </label>
            </div>
          </div>

          <!-- Income from separate property -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Proposed treatment of income from separate property (rents, dividends, interest):</label>
            <div class="flex flex-wrap gap-4">
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="sep_property_income" value="Community" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">Community (Texas default)</span>
              </label>
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="sep_property_income" value="Separate" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">Separate property of the owning spouse</span>
              </label>
            </div>
          </div>

          <!-- Conditional: Household expenses -->
          <div data-show-when="sep_property_income" data-show-value="Separate" class="hidden">
            <label class="block text-sm font-medium text-gray-700 mb-1">If future earnings are separate, how will household expenses be shared?</label>
            <textarea name="household_expenses_plan" rows="4"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]"
              placeholder="e.g., Each spouse contributes 50% of household expenses from their separate income. Joint checking account funded equally for shared costs..."></textarea>
          </div>

          <!-- Also show household expenses if either spouse's earnings are separate -->
          <div data-show-when="karen_future_earnings" data-show-value="Karen's Separate" class="hidden">
            <div class="bg-amber-50 border-l-4 border-amber-500 p-4 text-sm text-amber-800">
              <strong>Note:</strong> If Karen&rsquo;s future earnings are separate property, address how shared household expenses (mortgage, utilities, insurance) will be funded.
            </div>
          </div>
          <div data-show-when="michael_future_earnings" data-show-value="Michael's Separate" class="hidden">
            <div class="bg-amber-50 border-l-4 border-amber-500 p-4 text-sm text-amber-800">
              <strong>Note:</strong> If Michael&rsquo;s future earnings are separate property, address how shared household expenses (mortgage, utilities, insurance) will be funded.
            </div>
          </div>
        </div>

        <div class="bg-amber-50 border-l-4 border-amber-500 p-4 text-sm text-amber-800 mt-4">
          <strong>Tax Advisory:</strong> Tax consequences of income characterization are outside the scope of the flat fee. Consult a CPA or tax attorney for advice on how income reclassification may affect filing status, deductions, and estimated payments.
        </div>
      </div>

    </div>
  </div>

  <!-- Navigation -->
  <div class="flex justify-between items-center mt-6">
    <button type="button" onclick="prevStep()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-md transition-colors">
      &larr; Previous
    </button>
    <button type="button" onclick="saveProgress(false)" class="border border-[#1e3a5f] text-[#1e3a5f] hover:bg-blue-50 px-4 py-2 rounded-md text-sm transition-colors">
      Save Progress
    </button>
    <button type="button" onclick="nextStep()" class="bg-[#1e3a5f] hover:bg-[#2c5282] text-white px-6 py-2 rounded-md transition-colors">
      Next &rarr;
    </button>
  </div>
</div>


<!-- ================================================================== -->
<!-- SECTION 12: SPOUSAL MAINTENANCE / SUPPORT                          -->
<!-- ================================================================== -->
<div class="step" data-step="12" style="display:none;">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-[#1e3a5f] text-white px-6 py-3 rounded-t-lg font-bold text-lg">
      Section 12: Spousal Maintenance / Support
    </div>
    <div class="p-6 space-y-6">

      <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-blue-800">
        <strong>Texas Law Note:</strong> Under Tex. Fam. Code &sect; 4.003(a)(4), spouses may agree to modify or waive spousal maintenance (alimony) rights in a marital property agreement. Any waiver must be entered voluntarily with adequate disclosure.
      </div>

      <!-- Maintenance Waiver -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Include spousal maintenance waiver in this agreement?</label>
        <div class="space-y-2">
          <label class="inline-flex items-center mr-6 cursor-pointer">
            <input type="radio" name="maintenance_waiver" value="Yes - Mutual Waiver" class="form-radio text-blue-600 mr-2">
            <span class="text-sm">Yes &mdash; Mutual waiver (both spouses waive)</span>
          </label><br>
          <label class="inline-flex items-center mr-6 cursor-pointer">
            <input type="radio" name="maintenance_waiver" value="Yes - Karen Only" class="form-radio text-blue-600 mr-2">
            <span class="text-sm">Yes &mdash; Karen waives maintenance rights only</span>
          </label><br>
          <label class="inline-flex items-center mr-6 cursor-pointer">
            <input type="radio" name="maintenance_waiver" value="Yes - Michael Only" class="form-radio text-blue-600 mr-2">
            <span class="text-sm">Yes &mdash; Michael waives maintenance rights only</span>
          </label><br>
          <label class="inline-flex items-center mr-6 cursor-pointer">
            <input type="radio" name="maintenance_waiver" value="No" class="form-radio text-blue-600 mr-2">
            <span class="text-sm">No &mdash; Do not include a maintenance waiver</span>
          </label>
        </div>
      </div>

      <div class="bg-amber-50 border-l-4 border-amber-500 p-4 text-sm text-amber-800">
        <strong>Enforceability Note:</strong> A maintenance waiver is unenforceable if it would leave the waiving spouse eligible for public assistance at the time enforcement is sought. Courts may also scrutinize waivers where there is a significant disparity in earning capacity.
      </div>

      <!-- Specific Terms -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Any specific terms regarding maintenance (cap, duration, conditions)?</label>
        <textarea name="maintenance_terms" rows="4"
          class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]"
          placeholder="e.g., If maintenance is not waived: cap at $3,000/month for a maximum of 36 months, payable only if marriage lasts at least 10 years. Terminates upon remarriage or cohabitation..."></textarea>
      </div>

    </div>
  </div>

  <!-- Navigation -->
  <div class="flex justify-between items-center mt-6">
    <button type="button" onclick="prevStep()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-md transition-colors">
      &larr; Previous
    </button>
    <button type="button" onclick="saveProgress(false)" class="border border-[#1e3a5f] text-[#1e3a5f] hover:bg-blue-50 px-4 py-2 rounded-md text-sm transition-colors">
      Save Progress
    </button>
    <button type="button" onclick="nextStep()" class="bg-[#1e3a5f] hover:bg-[#2c5282] text-white px-6 py-2 rounded-md transition-colors">
      Next &rarr;
    </button>
  </div>
</div>


<!-- ================================================================== -->
<!-- SECTION 13: ADDITIONAL PROVISIONS                                  -->
<!-- ================================================================== -->
<div class="step" data-step="13" style="display:none;">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-[#1e3a5f] text-white px-6 py-3 rounded-t-lg font-bold text-lg">
      Section 13: Additional Provisions
    </div>
    <div class="p-6 space-y-6">

      <!-- 13A. Death/Estate Planning -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">13A. Death &amp; Estate Planning Provisions</h3>
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Include provisions addressing property distribution upon death?</label>
            <div class="flex flex-wrap gap-4">
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="death_provisions" value="Yes" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">Yes</span>
              </label>
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="death_provisions" value="No" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">No</span>
              </label>
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Require either party to maintain life insurance?</label>
            <div class="flex flex-wrap gap-4">
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="life_insurance_required" value="Yes" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">Yes</span>
              </label>
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="life_insurance_required" value="No" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">No</span>
              </label>
            </div>
          </div>
          <div data-show-when="life_insurance_required" data-show-value="Yes" class="hidden">
            <label class="block text-sm font-medium text-gray-700 mb-1">Describe life insurance terms (minimum coverage, beneficiary requirements, etc.):</label>
            <textarea name="life_insurance_terms" rows="3"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]"
              placeholder="e.g., Each party maintains a $500,000 term life policy naming the other as beneficiary for the duration of the marriage..."></textarea>
          </div>
        </div>
        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-blue-800 mt-3">
          <strong>Note:</strong> Estate planning beyond the scope of the marital agreement (wills, trusts, powers of attorney) requires a separate engagement.
        </div>
      </div>

      <!-- 13B. Sunset Clause -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">13B. Sunset Clause</h3>
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Include a sunset clause (agreement expires after a set number of years)?</label>
            <div class="flex flex-wrap gap-4">
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="sunset_clause" value="Yes" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">Yes</span>
              </label>
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="sunset_clause" value="No" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">No</span>
              </label>
            </div>
          </div>
          <div data-show-when="sunset_clause" data-show-value="Yes" class="hidden">
            <label class="block text-sm font-medium text-gray-700 mb-1">Number of years until the agreement sunsets:</label>
            <input type="number" name="sunset_years" min="1" max="99"
              class="w-32 border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              placeholder="e.g., 10">
          </div>
        </div>
      </div>

      <!-- 13C. Dispute Resolution -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">13C. Dispute Resolution</h3>
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Require mandatory mediation before litigation?</label>
            <div class="flex flex-wrap gap-4">
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="mandatory_mediation" value="Yes" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">Yes</span>
              </label>
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="mandatory_mediation" value="No" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">No</span>
              </label>
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Include binding arbitration clause?</label>
            <div class="flex flex-wrap gap-4">
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="arbitration_clause" value="Yes" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">Yes</span>
              </label>
              <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="arbitration_clause" value="No" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">No</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- 13D. Independent Counsel -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">13D. Independent Counsel for Michael</h3>
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Will Michael retain independent legal counsel?</label>
            <div class="space-y-2">
              <label class="inline-flex items-center mr-6 cursor-pointer">
                <input type="radio" name="michael_independent_counsel" value="Yes" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">Yes</span>
              </label><br>
              <label class="inline-flex items-center mr-6 cursor-pointer">
                <input type="radio" name="michael_independent_counsel" value="No" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">No</span>
              </label><br>
              <label class="inline-flex items-center mr-6 cursor-pointer">
                <input type="radio" name="michael_independent_counsel" value="Undecided" class="form-radio text-blue-600 mr-2">
                <span class="text-sm">Undecided</span>
              </label>
            </div>
          </div>
          <div data-show-when="michael_independent_counsel" data-show-value="Yes" class="hidden">
            <label class="block text-sm font-medium text-gray-700 mb-1">Attorney name and contact information:</label>
            <textarea name="michael_attorney_info" rows="3"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]"
              placeholder="Name, firm, phone, email"></textarea>
          </div>
        </div>
        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-blue-800 mt-3">
          <strong>Strongly Recommended:</strong> Independent counsel for both parties is strongly recommended and significantly strengthens enforceability of the agreement. Texas courts look favorably on agreements where both parties had the opportunity to consult with their own attorney.
        </div>
      </div>

      <!-- 13E. Additional Terms -->
      <div>
        <h3 class="text-[#2c5282] font-semibold text-base border-b border-gray-200 pb-2 mb-4">13E. Additional Terms or Provisions</h3>
        <label class="block text-sm font-medium text-gray-700 mb-1">List any additional terms, conditions, or provisions you want included in the agreement:</label>
        <textarea name="additional_terms" rows="6"
          class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[100px]"
          placeholder="e.g., Non-compete restrictions on business interests, provisions for future-acquired property, pet custody arrangements, social media/confidentiality clauses..."></textarea>
      </div>

    </div>
  </div>

  <!-- Navigation -->
  <div class="flex justify-between items-center mt-6">
    <button type="button" onclick="prevStep()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-md transition-colors">
      &larr; Previous
    </button>
    <button type="button" onclick="saveProgress(false)" class="border border-[#1e3a5f] text-[#1e3a5f] hover:bg-blue-50 px-4 py-2 rounded-md text-sm transition-colors">
      Save Progress
    </button>
    <button type="button" onclick="nextStep()" class="bg-[#1e3a5f] hover:bg-[#2c5282] text-white px-6 py-2 rounded-md transition-colors">
      Next &rarr;
    </button>
  </div>
</div>


<!-- ================================================================== -->
<!-- SECTION 14: DOCUMENTS TO UPLOAD TO DROPBOX                         -->
<!-- ================================================================== -->
<div class="step" data-step="14" style="display:none;">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-[#1e3a5f] text-white px-6 py-3 rounded-t-lg font-bold text-lg">
      Section 14: Documents to Upload to Dropbox
    </div>
    <div class="p-6 space-y-6">

      <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-blue-800">
        Upload the following documents to the shared Dropbox folder as they become available. Check each item below once the document has been uploaded or is not applicable.
      </div>

      <!-- Document Checklist -->
      <div class="space-y-3">
        <p class="text-sm font-medium text-gray-700">Document Checklist:</p>

        <label class="flex items-start gap-3 cursor-pointer">
          <input type="checkbox" name="doc_checklist_intake" value="yes" class="form-checkbox text-blue-600 mt-0.5 rounded">
          <span class="text-sm text-gray-700">1. Completed intake questionnaire (this form)</span>
        </label>

        <label class="flex items-start gap-3 cursor-pointer">
          <input type="checkbox" name="doc_checklist_division" value="yes" class="form-checkbox text-blue-600 mt-0.5 rounded">
          <span class="text-sm text-gray-700">2. Division of assets document (already uploaded &mdash; final version)</span>
        </label>

        <label class="flex items-start gap-3 cursor-pointer">
          <input type="checkbox" name="doc_checklist_marriage_cert" value="yes" class="form-checkbox text-blue-600 mt-0.5 rounded">
          <span class="text-sm text-gray-700">3. Marriage certificate</span>
        </label>

        <label class="flex items-start gap-3 cursor-pointer">
          <input type="checkbox" name="doc_checklist_existing_agreements" value="yes" class="form-checkbox text-blue-600 mt-0.5 rounded">
          <span class="text-sm text-gray-700">4. Any existing premarital or property agreements</span>
        </label>

        <label class="flex items-start gap-3 cursor-pointer">
          <input type="checkbox" name="doc_checklist_deeds" value="yes" class="form-checkbox text-blue-600 mt-0.5 rounded">
          <span class="text-sm text-gray-700">5. Deed(s) and/or mortgage statements for all real property</span>
        </label>

        <label class="flex items-start gap-3 cursor-pointer">
          <input type="checkbox" name="doc_checklist_account_statements" value="yes" class="form-checkbox text-blue-600 mt-0.5 rounded">
          <span class="text-sm text-gray-700">6. Most recent statements for all bank, investment, and retirement accounts</span>
        </label>

        <label class="flex items-start gap-3 cursor-pointer">
          <input type="checkbox" name="doc_checklist_business_docs" value="yes" class="form-checkbox text-blue-600 mt-0.5 rounded">
          <span class="text-sm text-gray-700">7. Business formation documents (articles, operating agreement, bylaws)</span>
        </label>

        <label class="flex items-start gap-3 cursor-pointer">
          <input type="checkbox" name="doc_checklist_business_tax" value="yes" class="form-checkbox text-blue-600 mt-0.5 rounded">
          <span class="text-sm text-gray-700">8. Most recent business tax returns (1&ndash;2 years) or financial statements</span>
        </label>

        <label class="flex items-start gap-3 cursor-pointer">
          <input type="checkbox" name="doc_checklist_vehicles" value="yes" class="form-checkbox text-blue-600 mt-0.5 rounded">
          <span class="text-sm text-gray-700">9. Vehicle titles and loan statements</span>
        </label>

        <label class="flex items-start gap-3 cursor-pointer">
          <input type="checkbox" name="doc_checklist_personal_tax" value="yes" class="form-checkbox text-blue-600 mt-0.5 rounded">
          <span class="text-sm text-gray-700">10. Most recent personal tax returns (1&ndash;2 years, all schedules)</span>
        </label>

        <label class="flex items-start gap-3 cursor-pointer">
          <input type="checkbox" name="doc_checklist_life_insurance" value="yes" class="form-checkbox text-blue-600 mt-0.5 rounded">
          <span class="text-sm text-gray-700">11. Life insurance policy declarations pages</span>
        </label>

        <label class="flex items-start gap-3 cursor-pointer">
          <input type="checkbox" name="doc_checklist_other" value="yes" class="form-checkbox text-blue-600 mt-0.5 rounded">
          <span class="text-sm text-gray-700">12. Any other documents referenced in your answers above</span>
        </label>
      </div>

      <!-- File Upload Area -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Upload All Documents:</label>
        <div class="file-upload-area border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-400 transition-colors cursor-pointer" data-upload="dropbox_documents">
          <svg class="mx-auto h-12 w-12 text-gray-400 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/></svg>
          <p class="text-base text-gray-600 font-medium">Drag &amp; drop files here, or <span class="text-blue-600">click to browse</span></p>
          <p class="text-xs text-gray-400 mt-2">PDF, DOC, DOCX, JPG, PNG, XLS, XLSX &mdash; Max 25 MB per file &mdash; Multiple files allowed</p>
          <input type="file" class="hidden" name="dropbox_files" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.xlsx,.xls">
        </div>
        <div class="file-list mt-2 space-y-1" data-list="dropbox_documents"></div>
      </div>

      <!-- Dropbox Link Reminder -->
      <div class="bg-[#1e3a5f] text-white rounded-lg p-5 text-center">
        <svg class="mx-auto h-8 w-8 mb-2 opacity-80" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2L6 6.5l6 4.5 6-4.5L12 2zM6 11l6 4.5 6-4.5-6-4.5L6 11zm6 5.5L6 12v.5l6 4.5 6-4.5V12l-6 4.5z"/></svg>
        <p class="font-semibold text-lg mb-1">Shared Dropbox Folder</p>
        <p class="text-sm text-blue-200">You can also upload documents directly to the shared Dropbox folder provided by The Talley Law Firm. Check your email for the Dropbox folder invitation link.</p>
      </div>

    </div>
  </div>

  <!-- Navigation -->
  <div class="flex justify-between items-center mt-6">
    <button type="button" onclick="prevStep()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-md transition-colors">
      &larr; Previous
    </button>
    <button type="button" onclick="saveProgress(false)" class="border border-[#1e3a5f] text-[#1e3a5f] hover:bg-blue-50 px-4 py-2 rounded-md text-sm transition-colors">
      Save Progress
    </button>
    <button type="button" onclick="nextStep()" class="bg-[#1e3a5f] hover:bg-[#2c5282] text-white px-6 py-2 rounded-md transition-colors">
      Next &rarr;
    </button>
  </div>
</div>


<!-- ================================================================== -->
<!-- SECTION 15: CERTIFICATION & SIGNATURE                              -->
<!-- ================================================================== -->
<div class="step" data-step="15" style="display:none;">
  <div class="bg-white shadow-md rounded-lg overflow-hidden mb-6">
    <div class="bg-[#1e3a5f] text-white px-6 py-3 rounded-t-lg font-bold text-lg">
      Section 15: Certification &amp; Signature
    </div>
    <div class="p-6 space-y-6">

      <!-- Certification Text -->
      <div class="bg-gray-50 border border-gray-200 rounded-lg p-5">
        <p class="text-sm text-gray-800 leading-relaxed">
          I certify that the information provided in this questionnaire is true and correct to the best of my knowledge. I understand that the accuracy of this information is important for the preparation of an enforceable marital property agreement, and that incomplete or inaccurate information may affect the enforceability of the agreement. I understand that the financial disclosure attached to or derived from this questionnaire will be incorporated into the agreement as required by Texas law.
        </p>
      </div>

      <!-- Signature Fields -->
      <div class="space-y-5">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Signature</label>
          <input type="text" name="certification_signature"
            class="w-full border-0 border-b-2 border-gray-400 px-3 py-3 text-lg focus:ring-0 focus:border-blue-600 bg-transparent"
            style="font-family: 'Brush Script MT', 'Segoe Script', cursive; font-size: 1.5rem;"
            placeholder="Type your full legal name as signature">
          <p class="text-xs text-gray-500 mt-1">By typing your name above, you acknowledge this serves as your electronic signature.</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Printed Name</label>
            <input type="text" name="certification_printed_name"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Date</label>
            <input type="date" name="certification_date"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          </div>
        </div>
      </div>

      <!-- Submit Warning -->
      <div class="bg-amber-50 border-l-4 border-amber-500 p-4 text-sm text-amber-800">
        <strong>Before submitting:</strong> Please review all sections for accuracy. Once submitted, your attorney will review the responses and may follow up with clarifying questions. You can still save a draft and return later using your unique link.
      </div>

    </div>
  </div>

  <!-- Navigation & Submit -->
  <div class="flex justify-between items-center mt-6">
    <button type="button" onclick="prevStep()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-md transition-colors">
      &larr; Previous
    </button>
    <div class="flex gap-3">
      <button type="button" onclick="saveProgress(false)" class="border border-[#1e3a5f] text-[#1e3a5f] hover:bg-blue-50 px-4 py-2 rounded-md text-sm transition-colors">
        Save Draft
      </button>
      <button type="button" onclick="submitForm()" class="bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-md text-lg font-semibold transition-colors shadow-lg">
        Submit Questionnaire
      </button>
    </div>
  </div>
</div>

      </form>
      <!-- ============================================================ -->
      <!-- END OF FORM STEPS                                            -->
      <!-- ============================================================ -->


      <!-- ============================================================ -->
      <!-- CONFIRMATION PAGE (hidden until successful submit)           -->
      <!-- ============================================================ -->
      <div id="confirmation-page" class="hidden">
        <div class="bg-white shadow-lg rounded-lg overflow-hidden max-w-2xl mx-auto mt-8">
          <div class="bg-green-600 text-white px-6 py-8 text-center">
            <svg class="mx-auto h-16 w-16 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <h2 class="text-2xl font-bold">Submission Successful</h2>
            <p class="text-green-100 mt-2">Your intake questionnaire has been submitted successfully.</p>
          </div>
          <div class="p-6 space-y-4">
            <div class="bg-gray-50 rounded-lg p-4 space-y-2">
              <div class="flex justify-between text-sm">
                <span class="text-gray-600">Client Name:</span>
                <span id="confirm-client-name" class="font-medium text-gray-900">--</span>
              </div>
              <div class="flex justify-between text-sm">
                <span class="text-gray-600">Date Submitted:</span>
                <span id="confirm-date" class="font-medium text-gray-900">--</span>
              </div>
              <div class="flex justify-between text-sm">
                <span class="text-gray-600">Reference Token:</span>
                <span id="confirm-token" class="font-mono text-xs text-gray-700 break-all">--</span>
              </div>
            </div>

            <button type="button" onclick="downloadJSON()"
              class="w-full bg-[#1e3a5f] hover:bg-[#2c5282] text-white px-6 py-3 rounded-md font-medium transition-colors">
              Download Responses as JSON
            </button>

            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-blue-800">
              <p class="font-medium mb-1">What happens next?</p>
              <p>Your attorney will review your responses and follow up with any clarifying questions. If you uploaded documents through this form, they will be stored securely. You may also continue to upload documents directly to the shared Dropbox folder.</p>
            </div>

            <div class="text-center text-sm text-gray-600 pt-4 border-t border-gray-200">
              <p class="font-medium">The Talley Law Firm PLLC</p>
              <p>4310 Westheimer Road, Suite 206</p>
              <p>Houston, Texas 77027</p>
              <p class="mt-1">(713) 521-3600</p>
            </div>
          </div>
        </div>
      </div>

    </div>
    <!-- /.max-w-4xl container -->

    <!-- ============================================================ -->
    <!-- TOAST NOTIFICATION CONTAINER                                  -->
    <!-- ============================================================ -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <!-- ============================================================ -->
    <!-- FOOTER                                                        -->
    <!-- ============================================================ -->
    <footer class="bg-[#1e3a5f] text-white text-center py-4 mt-8 text-sm">
      <p>CONFIDENTIAL &mdash; The Talley Law Firm PLLC &mdash; All Rights Reserved</p>
      <p class="text-gray-400 text-xs mt-1">4310 Westheimer Road, Suite 206, Houston, Texas 77027 &middot; (713) 521-3600</p>
    </footer>


<!-- ================================================================== -->
<!-- JAVASCRIPT — Complete Application Logic                            -->
<!-- ================================================================== -->
<script>
/* ===================================================================
   1. CONFIGURATION
   =================================================================== */
const CONFIG = {
  webhookUrl: 'https://atalley.app.n8n.cloud/webhook/bergeron-intake',
  supabaseUrl: 'https://hialadssyitrehievsab.supabase.co',
  supabaseAnonKey: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhpYWxhZHNzeWl0cmVoaWV2c2FiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY3NzUxMTIsImV4cCI6MjA4MjM1MTExMn0.ZCHdlMfAGbLuhXL0CDnr894YMEZTvEp3abH2h4enqxk',
  autoSaveInterval: 30000,
  maxFileSize: 25 * 1024 * 1024,
  allowedFileTypes: ['.pdf', '.doc', '.docx', '.jpg', '.jpeg', '.png', '.xlsx', '.xls'],
  totalSteps: 15
};

/* ===================================================================
   2. STATE MANAGEMENT
   =================================================================== */
let currentStep = 1;
let formToken = null;
let uploadedFiles = {};
let autoSaveTimer = null;

/* ===================================================================
   3. INITIALIZATION
   =================================================================== */
document.addEventListener('DOMContentLoaded', function () {
  // Check for token in URL params for resume
  const urlParams = new URLSearchParams(window.location.search);
  const tokenParam = urlParams.get('token');

  if (tokenParam) {
    formToken = tokenParam;
    loadDraft(tokenParam);
  } else {
    // Check localStorage fallback
    const savedDraft = localStorage.getItem('bergeron_intake_draft');
    if (savedDraft) {
      try {
        const draft = JSON.parse(savedDraft);
        formToken = draft.token || generateUUID();
        if (draft.currentStep) currentStep = draft.currentStep;
        if (draft.responses) populateForm(draft.responses);
      } catch (e) {
        console.warn('Could not parse saved draft:', e);
        formToken = generateUUID();
      }
    } else {
      formToken = generateUUID();
    }
  }

  // Set the certification date to today
  const dateField = document.querySelector('input[name="certification_date"]');
  if (dateField && !dateField.value) {
    dateField.value = new Date().toISOString().split('T')[0];
  }

  // Initialize conditional field logic
  initConditionalFields();

  // Initialize file upload areas
  initFileUploads();

  // Initialize dynamic table row buttons
  initDynamicRows();

  // Show the current step
  showStep(currentStep);

  // Start auto-save timer
  autoSaveTimer = setInterval(function () {
    autoSaveToLocalStorage();
  }, CONFIG.autoSaveInterval);
});

/* ===================================================================
   4. STEP NAVIGATION
   =================================================================== */
function showStep(n) {
  // Clamp step number
  if (n < 1) n = 1;
  if (n > CONFIG.totalSteps) n = CONFIG.totalSteps;

  // Hide all steps
  const steps = document.querySelectorAll('.step');
  steps.forEach(function (step) {
    step.style.display = 'none';
  });

  // Show target step
  const target = document.querySelector('.step[data-step="' + n + '"]');
  if (target) {
    target.style.display = 'block';
  }

  currentStep = n;

  // Update progress bar
  updateProgressBar();

  // Scroll to top
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function nextStep() {
  if (!validateStep(currentStep)) return;
  if (currentStep < CONFIG.totalSteps) {
    showStep(currentStep + 1);
  }
}

function prevStep() {
  if (currentStep > 1) {
    showStep(currentStep - 1);
  }
}

function updateProgressBar() {
  const progressFill = document.getElementById('progress-fill');
  const progressText = document.getElementById('progress-text');

  if (progressFill) {
    const pct = Math.round((currentStep / CONFIG.totalSteps) * 100);
    progressFill.style.width = pct + '%';
  }

  if (progressText) {
    progressText.textContent = 'Step ' + currentStep + ' of ' + CONFIG.totalSteps;
  }
}

/* ===================================================================
   5. CONDITIONAL FIELD LOGIC
   =================================================================== */
function initConditionalFields() {
  // Listen for changes on all radios, selects, and checkboxes
  const form = document.getElementById('intake-form');
  if (!form) return;

  form.addEventListener('change', function (e) {
    evaluateConditionals();
  });

  // Run once on init
  evaluateConditionals();
}

function evaluateConditionals() {
  const conditionals = document.querySelectorAll('[data-show-when]');
  conditionals.forEach(function (el) {
    const fieldName = el.getAttribute('data-show-when');
    const showValue = el.getAttribute('data-show-value');

    // Get current value of the referenced field
    const fieldValue = getFieldValue(fieldName);

    if (fieldValue === showValue) {
      el.classList.remove('hidden');
      // Support Part 1 data-conditional pattern
      if (el.hasAttribute('data-conditional')) el.classList.add('visible');
    } else {
      el.classList.add('hidden');
      if (el.hasAttribute('data-conditional')) el.classList.remove('visible');
    }
  });
}

function getFieldValue(name) {
  // Check radio buttons first
  const radios = document.querySelectorAll('input[name="' + name + '"]');
  if (radios.length > 0) {
    for (let i = 0; i < radios.length; i++) {
      if (radios[i].checked) return radios[i].value;
    }
    return '';
  }

  // Check select
  const select = document.querySelector('select[name="' + name + '"]');
  if (select) return select.value;

  // Check text/textarea
  const input = document.querySelector('input[name="' + name + '"], textarea[name="' + name + '"]');
  if (input) return input.value;

  return '';
}

/* ===================================================================
   6. FORM DATA COLLECTION
   =================================================================== */
function collectFormData() {
  const form = document.getElementById('intake-form');
  if (!form) return {};

  const data = {};
  const elements = form.elements;

  for (let i = 0; i < elements.length; i++) {
    const el = elements[i];
    const name = el.name;
    if (!name || name === 'website') continue; // skip honeypot

    if (el.type === 'radio') {
      if (el.checked) {
        data[name] = el.value;
      }
    } else if (el.type === 'checkbox') {
      if (!data[name]) data[name] = [];
      if (el.checked) {
        if (Array.isArray(data[name])) {
          data[name].push(el.value);
        } else {
          data[name] = [data[name], el.value];
        }
      }
    } else if (el.type === 'select-multiple') {
      const selected = [];
      for (let j = 0; j < el.options.length; j++) {
        if (el.options[j].selected) selected.push(el.options[j].value);
      }
      data[name] = selected;
    } else if (el.type === 'file') {
      // Files handled separately via uploadedFiles
      continue;
    } else {
      if (el.value) data[name] = el.value;
    }
  }

  // Collect dynamic table rows
  const tables = document.querySelectorAll('[data-table]');
  tables.forEach(function (table) {
    const tableName = table.getAttribute('data-table');
    const rows = table.querySelectorAll('.dynamic-row');
    const rowData = [];
    rows.forEach(function (row) {
      const rowObj = {};
      const inputs = row.querySelectorAll('input, select, textarea');
      inputs.forEach(function (inp) {
        if (inp.name) {
          // Strip row suffix for a clean key
          const key = inp.name.replace(/_row\d+$/, '');
          rowObj[key] = inp.value;
        }
      });
      if (Object.keys(rowObj).length > 0) rowData.push(rowObj);
    });
    if (rowData.length > 0) data[tableName] = rowData;
  });

  // Organize into sections
  const organized = {
    section1_client_info: {},
    section2_real_property: {},
    section3_business_interests: {},
    section4_financial_accounts: {},
    section5_vehicles_personal_property: {},
    section6_debts_insurance: {},
    section7_debts_liabilities: {},
    section8_separate_property: {},
    section9_proposed_division: {},
    section10_comments: {},
    section11_income: {},
    section12_maintenance: {},
    section13_additional: {},
    section14_documents: {},
    section15_certification: {}
  };

  // Map fields to sections by prefix patterns
  const sectionMappings = [
    { prefix: ['s1_client_', 's1_spouse_', 's1_marriage_', 'client_', 'spouse_', 'karen_full_name', 'karen_dob', 'karen_ssn_last4', 'karen_address', 'karen_phone', 'karen_email', 'michael_full_name', 'michael_dob', 'michael_ssn_last4', 'michael_address', 'michael_phone', 'michael_email'], section: 'section1_client_info' },
    { prefix: ['s2_p1_', 's2_p2_', 's2_additional'], section: 'section2_real_property' },
    { prefix: ['s3_b1_', 's3_additional'], section: 'section3_business_interests' },
    { prefix: ['s4a_', 's4b_', 's4c_', 's4d_'], section: 'section4_financial_accounts' },
    { prefix: ['s5a_', 's5b_', 's5c_'], section: 'section5_vehicles_personal_property' },
    { prefix: ['s6a_', 's6b_'], section: 'section6_debts_insurance' },
    { prefix: ['s7_', 'table_debts'], section: 'section7_debts_liabilities' },
    { prefix: ['karen_separate', 'michael_separate', 'separate_property'], section: 'section8_separate_property' },
    { prefix: ['agreement_type', 'division_'], section: 'section9_proposed_division' },
    { prefix: ['general_comments', 'attorney_comments'], section: 'section10_comments' },
    { prefix: ['karen_salary', 'karen_pay', 'karen_bonus', 'karen_business_dist', 'karen_rental', 'karen_other_income', 'michael_salary', 'michael_pay', 'michael_bonus', 'michael_business_dist', 'michael_rental', 'michael_other_income', 'karen_future', 'michael_future', 'sep_property_income', 'household_expenses'], section: 'section11_income' },
    { prefix: ['maintenance_'], section: 'section12_maintenance' },
    { prefix: ['death_', 'life_insurance', 'sunset_', 'mandatory_mediation', 'arbitration_', 'michael_independent', 'michael_attorney', 'additional_terms'], section: 'section13_additional' },
    { prefix: ['doc_checklist'], section: 'section14_documents' },
    { prefix: ['certification_'], section: 'section15_certification' }
  ];

  Object.keys(data).forEach(function (key) {
    let placed = false;
    for (let m = 0; m < sectionMappings.length; m++) {
      const mapping = sectionMappings[m];
      for (let p = 0; p < mapping.prefix.length; p++) {
        if (key.indexOf(mapping.prefix[p]) === 0 || key === mapping.prefix[p]) {
          organized[mapping.section][key] = data[key];
          placed = true;
          break;
        }
      }
      if (placed) break;
    }
    if (!placed) {
      // Put unmapped fields at root
      organized[key] = data[key];
    }
  });

  return organized;
}

/* ===================================================================
   7. SAVE PROGRESS
   =================================================================== */
function saveProgress(isFinal) {
  // Honeypot check
  const honeypot = document.querySelector('input[name="website"]');
  if (honeypot && honeypot.value) {
    console.log('Bot detected');
    return;
  }

  const responses = collectFormData();

  // Get client and spouse names from form
  const clientNameEl = document.querySelector('input[name="s1_client_fullName"]') ||
                       document.querySelector('input[name="karen_full_name"]') ||
                       document.querySelector('input[name="client_full_name"]');
  const spouseNameEl = document.querySelector('input[name="s1_spouse_fullName"]') ||
                       document.querySelector('input[name="michael_full_name"]') ||
                       document.querySelector('input[name="spouse_full_name"]');

  const clientName = clientNameEl ? clientNameEl.value : '';
  const spouseName = spouseNameEl ? spouseNameEl.value : '';

  // Build file metadata
  const filesMeta = [];
  Object.keys(uploadedFiles).forEach(function (key) {
    uploadedFiles[key].forEach(function (file) {
      filesMeta.push({
        fieldName: key,
        fileName: file.name,
        fileSize: file.size,
        fileType: file.type
      });
    });
  });

  const payload = {
    token: formToken,
    status: isFinal ? 'final' : 'draft',
    currentStep: currentStep,
    responses: responses,
    clientName: clientName,
    spouseName: spouseName,
    files: filesMeta,
    submittedAt: isFinal ? new Date().toISOString() : null,
    userAgent: navigator.userAgent
  };

  // Save to localStorage
  localStorage.setItem('bergeron_intake_draft', JSON.stringify(payload));

  // POST to webhook
  fetch(CONFIG.webhookUrl, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(payload)
  })
  .then(function (res) {
    if (!res.ok) throw new Error('Server responded with ' + res.status);
    return res.json().catch(function () { return {}; });
  })
  .then(function (result) {
    if (isFinal) {
      showConfirmation(clientName, formToken);
      showToast('Questionnaire submitted successfully!', 'success');
    } else {
      showToast('Progress saved successfully.', 'success');
      // Update URL with token for bookmarking
      if (window.history && window.history.replaceState) {
        const url = new URL(window.location);
        url.searchParams.set('token', formToken);
        window.history.replaceState({}, '', url);
      }
    }
  })
  .catch(function (err) {
    console.error('Save error:', err);
    if (isFinal) {
      showToast('Submission saved locally. Server connection failed — your attorney will receive it when connectivity is restored.', 'error');
      // Still show confirmation since we saved locally
      showConfirmation(clientName, formToken);
    } else {
      showToast('Saved locally. Server sync will retry.', 'error');
    }
  });

  // Upload files if any
  uploadFilesToWebhook(payload);
}

function uploadFilesToWebhook(payload) {
  Object.keys(uploadedFiles).forEach(function (key) {
    uploadedFiles[key].forEach(function (fileObj) {
      if (fileObj.base64) {
        // File already encoded, included in next save
        return;
      }
      const reader = new FileReader();
      reader.onload = function (e) {
        fileObj.base64 = e.target.result;
      };
      reader.readAsDataURL(fileObj.file || fileObj);
    });
  });
}

function submitForm() {
  // Confirm before final submission
  if (!confirm('Are you ready to submit your completed questionnaire? You will not be able to edit your responses after submission.')) {
    return;
  }

  saveProgress(true);
}

/* ===================================================================
   8. RESUME FROM SUPABASE
   =================================================================== */
function loadDraft(token) {
  const url = CONFIG.supabaseUrl + '/rest/v1/marital_agreement_intakes?token=eq.' + encodeURIComponent(token) + '&select=*';

  fetch(url, {
    method: 'GET',
    headers: {
      'apikey': CONFIG.supabaseAnonKey,
      'Authorization': 'Bearer ' + CONFIG.supabaseAnonKey,
      'Content-Type': 'application/json'
    }
  })
  .then(function (res) {
    if (!res.ok) throw new Error('Supabase responded with ' + res.status);
    return res.json();
  })
  .then(function (rows) {
    if (rows && rows.length > 0) {
      const draft = rows[0];
      formToken = draft.token;

      if (draft.responses) {
        const responses = typeof draft.responses === 'string' ? JSON.parse(draft.responses) : draft.responses;
        populateForm(responses);
      }

      if (draft.current_step) {
        currentStep = draft.current_step;
      }

      showStep(currentStep);
      showToast('Draft loaded successfully.', 'success');
    } else {
      // No draft found, try localStorage
      const savedDraft = localStorage.getItem('bergeron_intake_draft');
      if (savedDraft) {
        try {
          const draft = JSON.parse(savedDraft);
          if (draft.token === token && draft.responses) {
            populateForm(draft.responses);
            if (draft.currentStep) currentStep = draft.currentStep;
          }
        } catch (e) { /* ignore */ }
      }
      showStep(currentStep);
    }
  })
  .catch(function (err) {
    console.warn('Could not load from Supabase, trying localStorage:', err);
    // Fallback to localStorage
    const savedDraft = localStorage.getItem('bergeron_intake_draft');
    if (savedDraft) {
      try {
        const draft = JSON.parse(savedDraft);
        if (draft.token === token && draft.responses) {
          populateForm(draft.responses);
          if (draft.currentStep) currentStep = draft.currentStep;
        }
      } catch (e) { /* ignore */ }
    }
    showStep(currentStep);
  });
}

function populateForm(responses) {
  if (!responses || typeof responses !== 'object') return;

  // Flatten nested section objects
  const flat = {};
  Object.keys(responses).forEach(function (key) {
    if (typeof responses[key] === 'object' && !Array.isArray(responses[key]) && responses[key] !== null) {
      // This is a section object — flatten its contents
      Object.keys(responses[key]).forEach(function (innerKey) {
        flat[innerKey] = responses[key][innerKey];
      });
    } else {
      flat[key] = responses[key];
    }
  });

  Object.keys(flat).forEach(function (name) {
    const value = flat[name];

    // Handle radio buttons
    const radios = document.querySelectorAll('input[name="' + name + '"][type="radio"]');
    if (radios.length > 0) {
      radios.forEach(function (r) {
        r.checked = (r.value === value);
      });
      return;
    }

    // Handle checkboxes
    const checkboxes = document.querySelectorAll('input[name="' + name + '"][type="checkbox"]');
    if (checkboxes.length > 0) {
      const values = Array.isArray(value) ? value : [value];
      checkboxes.forEach(function (cb) {
        cb.checked = values.indexOf(cb.value) !== -1;
      });
      return;
    }

    // Handle select, text, textarea
    const el = document.querySelector('[name="' + name + '"]');
    if (el) {
      el.value = value;
    }
  });

  // Re-evaluate conditionals after populating
  evaluateConditionals();
}

/* ===================================================================
   9. FILE UPLOAD HANDLING
   =================================================================== */
function initFileUploads() {
  const uploadAreas = document.querySelectorAll('.file-upload-area');

  uploadAreas.forEach(function (area) {
    const uploadKey = area.getAttribute('data-upload');
    const fileInput = area.querySelector('input[type="file"]');
    const fileList = document.querySelector('[data-list="' + uploadKey + '"]');

    if (!uploadKey || !fileInput) return;

    // Initialize storage
    if (!uploadedFiles[uploadKey]) uploadedFiles[uploadKey] = [];

    // Click to browse
    area.addEventListener('click', function (e) {
      if (e.target.tagName !== 'INPUT') {
        fileInput.click();
      }
    });

    // File input change
    fileInput.addEventListener('change', function () {
      handleFiles(this.files, uploadKey, fileList);
      this.value = ''; // reset so same file can be re-selected
    });

    // Drag and drop
    area.addEventListener('dragover', function (e) {
      e.preventDefault();
      e.stopPropagation();
      area.classList.add('border-blue-400', 'bg-blue-50');
    });

    area.addEventListener('dragleave', function (e) {
      e.preventDefault();
      e.stopPropagation();
      area.classList.remove('border-blue-400', 'bg-blue-50');
    });

    area.addEventListener('drop', function (e) {
      e.preventDefault();
      e.stopPropagation();
      area.classList.remove('border-blue-400', 'bg-blue-50');
      handleFiles(e.dataTransfer.files, uploadKey, fileList);
    });
  });
}

function handleFiles(files, uploadKey, fileListEl) {
  if (!files || files.length === 0) return;

  for (let i = 0; i < files.length; i++) {
    const file = files[i];

    // Validate file size
    if (file.size > CONFIG.maxFileSize) {
      showToast('File "' + file.name + '" exceeds the 25 MB limit.', 'error');
      continue;
    }

    // Validate file type
    const ext = '.' + file.name.split('.').pop().toLowerCase();
    if (CONFIG.allowedFileTypes.indexOf(ext) === -1) {
      showToast('File type "' + ext + '" is not allowed.', 'error');
      continue;
    }

    // Store file reference
    const fileObj = {
      file: file,
      name: file.name,
      size: file.size,
      type: file.type,
      base64: null
    };

    // Read as base64
    (function (fo) {
      const reader = new FileReader();
      reader.onload = function (e) {
        fo.base64 = e.target.result;
      };
      reader.readAsDataURL(fo.file);
    })(fileObj);

    uploadedFiles[uploadKey].push(fileObj);
  }

  // Refresh file list display
  renderFileList(uploadKey, fileListEl);
}

function renderFileList(uploadKey, fileListEl) {
  if (!fileListEl) return;
  fileListEl.innerHTML = '';

  uploadedFiles[uploadKey].forEach(function (fileObj, idx) {
    const div = document.createElement('div');
    div.className = 'flex items-center justify-between bg-gray-50 rounded px-3 py-2 text-sm';

    const sizeStr = formatFileSize(fileObj.size);

    div.innerHTML =
      '<div class="flex items-center gap-2">' +
        '<svg class="h-4 w-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>' +
        '<span class="text-gray-700">' + escapeHtml(fileObj.name) + '</span>' +
        '<span class="text-gray-400">(' + sizeStr + ')</span>' +
      '</div>' +
      '<button type="button" class="text-red-500 hover:text-red-700 text-xs font-medium" data-remove="' + idx + '">' +
        'Remove' +
      '</button>';

    div.querySelector('[data-remove]').addEventListener('click', function () {
      uploadedFiles[uploadKey].splice(idx, 1);
      renderFileList(uploadKey, fileListEl);
    });

    fileListEl.appendChild(div);
  });
}

function formatFileSize(bytes) {
  if (bytes === 0) return '0 B';
  const k = 1024;
  const sizes = ['B', 'KB', 'MB', 'GB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
}

function escapeHtml(text) {
  const div = document.createElement('div');
  div.appendChild(document.createTextNode(text));
  return div.innerHTML;
}

/* ===================================================================
   10. DYNAMIC TABLE ROWS
   =================================================================== */
function initDynamicRows() {
  document.querySelectorAll('[data-add-row]').forEach(function (btn) {
    btn.addEventListener('click', function () {
      const tableId = this.getAttribute('data-add-row');
      addDynamicRow(tableId);
    });
  });

  // Delegate remove-row clicks
  document.addEventListener('click', function (e) {
    if (e.target.closest('[data-remove-row]')) {
      const btn = e.target.closest('[data-remove-row]');
      const tableId = btn.getAttribute('data-remove-row');
      removeDynamicRow(btn, tableId);
    }
  });
}

function addDynamicRow(tableId) {
  const container = document.querySelector('[data-table="' + tableId + '"]');
  if (!container) return;

  const rows = container.querySelectorAll('.dynamic-row');
  if (rows.length === 0) return;

  const lastRow = rows[rows.length - 1];
  const clone = lastRow.cloneNode(true);

  // Clear values and update names
  const rowNum = rows.length + 1;
  clone.querySelectorAll('input, select, textarea').forEach(function (el) {
    if (el.type === 'checkbox' || el.type === 'radio') {
      el.checked = false;
    } else {
      el.value = '';
    }
    // Update name suffix
    if (el.name) {
      el.name = el.name.replace(/_row\d+$/, '') + '_row' + rowNum;
    }
  });

  container.appendChild(clone);
}

function removeDynamicRow(btn, tableId) {
  const container = document.querySelector('[data-table="' + tableId + '"]');
  if (!container) return;

  const rows = container.querySelectorAll('.dynamic-row');
  if (rows.length <= 1) {
    showToast('At least one row is required.', 'error');
    return;
  }

  const row = btn.closest('.dynamic-row');
  if (row) row.remove();
}

/* ===================================================================
   10B. ADD TABLE ROW (static tables in Sections 1-7)
   =================================================================== */
function addTableRow(tableId) {
  var table = document.getElementById(tableId);
  if (!table) return;
  var tbody = table.querySelector('tbody');
  if (!tbody) return;
  var rows = tbody.querySelectorAll('tr');
  if (rows.length === 0) return;
  var lastRow = rows[rows.length - 1];
  var clone = lastRow.cloneNode(true);
  var nextNum = rows.length + 1;
  clone.querySelectorAll('input, select, textarea').forEach(function(el) {
    el.value = '';
    if (el.name) {
      el.name = el.name.replace(/_(\d+)_/, '_' + nextNum + '_');
    }
  });
  tbody.appendChild(clone);
}

/* ===================================================================
   11. AUTO-SAVE TO LOCALSTORAGE
   =================================================================== */
function autoSaveToLocalStorage() {
  try {
    const responses = collectFormData();
    const clientNameEl = document.querySelector('input[name="s1_client_fullName"]') ||
                         document.querySelector('input[name="karen_full_name"]') ||
                         document.querySelector('input[name="client_full_name"]');
    const payload = {
      token: formToken,
      currentStep: currentStep,
      responses: responses,
      clientName: clientNameEl ? clientNameEl.value : '',
      savedAt: new Date().toISOString()
    };
    localStorage.setItem('bergeron_intake_draft', JSON.stringify(payload));
  } catch (e) {
    console.warn('Auto-save to localStorage failed:', e);
  }
}

/* ===================================================================
   12. FORM VALIDATION (per step)
   =================================================================== */
function validateStep(stepNum) {
  // All fields are optional — client fills out piecemeal across sessions
  return true;
}

/* ===================================================================
   13. TOAST NOTIFICATIONS
   =================================================================== */
function showToast(message, type) {
  const container = document.getElementById('toast-container');
  if (!container) return;

  const toast = document.createElement('div');
  const bgColor = type === 'success' ? 'bg-green-600' : 'bg-red-600';

  toast.className = bgColor + ' text-white px-5 py-3 rounded-lg shadow-lg text-sm max-w-sm transform transition-all duration-300 translate-x-full opacity-0';
  toast.textContent = message;

  container.appendChild(toast);

  // Animate in
  requestAnimationFrame(function () {
    toast.classList.remove('translate-x-full', 'opacity-0');
    toast.classList.add('translate-x-0', 'opacity-100');
  });

  // Auto dismiss after 4 seconds
  setTimeout(function () {
    toast.classList.add('translate-x-full', 'opacity-0');
    setTimeout(function () {
      if (toast.parentNode) toast.parentNode.removeChild(toast);
    }, 300);
  }, 4000);
}

/* ===================================================================
   14. JSON DOWNLOAD
   =================================================================== */
function downloadJSON() {
  const data = collectFormData();
  data._meta = {
    token: formToken,
    exportedAt: new Date().toISOString(),
    formVersion: '1.0',
    matter: 'Bergeron Marital Property Agreement'
  };

  const json = JSON.stringify(data, null, 2);
  const blob = new Blob([json], { type: 'application/json' });
  const url = URL.createObjectURL(blob);

  const dateStr = new Date().toISOString().split('T')[0];
  const filename = 'bergeron_intake_' + dateStr + '.json';

  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

/* ===================================================================
   15. HONEYPOT CHECK
   =================================================================== */
function checkHoneypot() {
  const honeypot = document.querySelector('input[name="website"]');
  if (honeypot && honeypot.value) {
    // Bot detected — silently return true to indicate bot
    return true;
  }
  return false;
}

/* ===================================================================
   16. UUID GENERATOR
   =================================================================== */
function generateUUID() {
  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
    const r = Math.random() * 16 | 0;
    const v = c === 'x' ? r : (r & 0x3 | 0x8);
    return v.toString(16);
  });
}

/* ===================================================================
   HELPER: Show Confirmation Page
   =================================================================== */
function showConfirmation(clientName, token) {
  // Hide the form
  const form = document.getElementById('intake-form');
  if (form) form.style.display = 'none';

  // Hide progress bar
  const progressBar = document.getElementById('progress-bar');
  if (progressBar) progressBar.style.display = 'none';

  // Show confirmation page
  const confirmation = document.getElementById('confirmation-page');
  if (confirmation) {
    confirmation.classList.remove('hidden');
  }

  // Fill in details
  const confirmName = document.getElementById('confirm-client-name');
  if (confirmName) confirmName.textContent = clientName || 'N/A';

  const confirmDate = document.getElementById('confirm-date');
  if (confirmDate) confirmDate.textContent = new Date().toLocaleDateString('en-US', {
    year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit'
  });

  const confirmToken = document.getElementById('confirm-token');
  if (confirmToken) confirmToken.textContent = token || 'N/A';

  // Clear auto-save timer
  if (autoSaveTimer) {
    clearInterval(autoSaveTimer);
    autoSaveTimer = null;
  }

  // Clear localStorage draft
  localStorage.removeItem('bergeron_intake_draft');

  // Scroll to top
  window.scrollTo({ top: 0, behavior: 'smooth' });
}
</script>

</div><!-- /form-content -->

</body>
</html>
